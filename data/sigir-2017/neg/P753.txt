Session 7A: Social

SIGIR’17, August 7-11, 2017, Shinjuku, Tokyo, Japan

Hierarchical Community-Level Information Diffusion Modeling
in Social Networks
Yuan Zhang

Department of Machine Intelligence
Key Laboratory of Machine
Perception (MOE)
Peking University, China
yuan.z@pku.edu.cn

Tianshu Lyu

Department of Machine Intelligence
Key Laboratory of Machine
Perception (MOE)
Peking University, China
lyutianshu@pku.edu.cn

Yan Zhang

Department of Machine Intelligence
Key Laboratory of Machine
Perception (MOE)
Peking University, China
zhy@cis.pku.edu.cn

ABSTRACT
Recently, online social networks are becoming increasingly popular
platforms for social interactions. Understanding how information
propagates in such networks is important for personalization and
recommendation in social search.
In this paper, we propose a Hierarchical Community-level Information Diffusion (HCID) model to capture the information diffusion
process in social networks. We introduce the notion of users’ topic
popularity as to enable our model to depict the information diffusion
process which is both topic-aware (which topic the information is
concerned with) and source-aware (where the information comes
from). Instead of assuming homogeneity of social communities,
we propose the notion of community hierarchy, where information
diffusion across inter-level communities is uni-directional from the
higher levels to the lower ones.
We design a Gibbs sampling algorithm to infer model parameters and propose prediction methods for two information diffusion
prediction tasks, the retweet prediction and the cascade prediction. Comparison experiments are conducted on two real datasets.
Results show that our model achieves substantial improvement
compared with the existing work.

Input:
relationship network and retweet log

Output:
hierarchical community level diffusion

influence
strengths
Lifestyle
Politics
Sports

topic interests

Sports
Lifestyle
Politics

topic popularity

Figure 1: Hierarchical Community Level Diffusion.

1

INTRODUCTION

In the era of Web 2.0, online social networks (OSN), such as Twitter,
Facebook and Weibo, are becoming increasingly popular platforms
for social interactions and communication. Social network users
form a large-scale complex network by establishing who-followswho relationships/friendships, and generate textual contents by
tweeting/posting. They also share semantic information through
their social network connections, e.g. retweeting/reposting, which
accounts for the majority of information diffusion in social networks. In this paper, we focus on modeling such information diffusion processes to gain better insight on the information spreading
mechanisms along with users’ topical and social preferences, which
are useful in many IR tasks such as personalized social search.
Related studies can be roughly divided into two main categories:
one is information diffusion modeling [3, 17, 19, 23, 36, 37], the
other is semantic analysis combining textual content with network
structures [4, 7–9, 16, 22, 24]. Although much progress has been
made, the existing work still suffers from several limitations:

CCS CONCEPTS
•Applied computing →Sociology; •Human-centered computing →Social networking sites; •Information systems →Data
mining;

KEYWORDS
social networks; communities; information diffusion
ACM Reference format:
Yuan Zhang, Tianshu Lyu, and Yan Zhang. 2017. Hierarchical CommunityLevel Information Diffusion Modeling in Social Networks. In Proceedings of
SIGIR ’17, August 7–11, 2017, Shinjuku, Tokyo, Japan, , 10 pages.
DOI: http://dx.doi.org/10.1145/3077136.3080784

• Most work in literature models information diffusion at
the individual level. However, the high volatility of user behaviors renders it difficult to accurately uncover diffusion
patterns for individual level models [19]. Moreover, those
models, especially influence-based ones e.g. [23, 34, 37],
become computationally prohibitive to inference when
dealing with large scale networks usually with more than
millions of nodes and billions of links.

Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for profit or commercial advantage and that copies bear this notice and the full citation
on the first page. Copyrights for components of this work owned by others than ACM
must be honored. Abstracting with credit is permitted. To copy otherwise, or republish,
to post on servers or to redistribute to lists, requires prior specific permission and/or a
fee. Request permissions from permissions@acm.org.
SIGIR ’17, August 7–11, 2017, Shinjuku, Tokyo, Japan
© 2017 ACM. 978-1-4503-5022-8/17/08. . . $15.00
DOI: http://dx.doi.org/10.1145/3077136.3080784

753

Session 7A: Social

SIGIR’17, August 7-11, 2017, Shinjuku, Tokyo, Japan

structure
This paper

social hierarchy
(directionality)
social tie strength

Existing work
topic interest

semantics
topic popularity
(expertise, authoritativenss, etc.)

Is this post
interesting to
users?

Does this post
come from someone popular in
its topic?

Figure 3: Follow relationship hierarchy in Weibo. The horizontal axis and the vertical axis denote the numbers of followers for users on the outward and inward sides of follow
relationships, respectively.

Figure 2: Two-dimension interleaving space for information
diffusion phenomena. Most existing work only tackles one
dimension or one point in the space.

Thus, we introduce the notion of community hierarchy, which
defines the direction of information flows at the community level
and enables our model to capture information diffusion patterns of
higher complexity. Further, empirical study verifies this intuition
and shows substantial model performance improvement on various
evaluation metrics.
Second, social communities are associated with similar topical
preferences in our model. Most approaches, concerning users’ topic
interests e.g. [16, 19, 22], assume that every user has a single topic
distribution, serving as both his/her topic interests and popularity.
However, a user’s interest in a topic (as a receiver) is not necessarily
the same as others’ interests towards him/her (as a sender) in that
topic. For example, a famous politician in Twitter might take strong
interests in American football, thereby retweeting a large amount
of posts3 about NFL games and only a few pieces of politics related
posts. Most people usually are not interested in the NFL news he
shares but those political opinions that account for only a small
proportion of his total posts. Therefore, we propose the notion of
communities’ topic popularity to capture this kind of source-aware
information diffusion phenomenon upon different topics.
Figure 1 summaries our proposed model. The input is a relationship network along with retweeting logs, each of which contains
the textual content, the source user and the target user (retweeter)
of a retweet. Our goal is to understand the mechanism of information diffusion across communities by extracting hierarchical
communities with their interests and popularity in different topics.
To conclude, the major contributions of this paper are:

• Few models holistically depict the retweeting behaviors,
which explicitly indicate information diffusion from source
users to target users (i.e. retweeters). For example, Hu et.
al. [19] model the retweet network and posts separately,
ignoring semantic information on retweet links as well as
posts’ retweeting source, which fails to capture the whole
retweeting process and has weaker performance as showed
in Section 3.2. [35, 37] have studied retweeting behaviors
systematically; nonetheless, the discriminative methods
they use make it only applicable to specific tasks, such as
the retweet prediction, but not to the others.
To overcome those limitations, we propose a unified information
diffusion approach, HCID (Hierarchical Community-level Information Diffusion), to jointly model information diffusion processes in
two dimensions, network structure and information semantics (see
Figure 2). The proposed approach models information diffusion at
the community level similarly to [19], yet our contribution extends
the notion of communities to better capture information diffusion
in those two dimensions respectively.1
First, the traditional concept of communities is typically only
concerned with social tie strengths to capture locally dense subgraph structures. However, social science studies reveal that social
communication exhibits hierarchy, in the sense that people from
higher level communities barely receive information from lower
level communities. For instance, influential users (celebrities, amusing story publishers etc.) are more popular and hence have more
followers, but they seldom follow “ordinary people” and cautiously
retweet their posts due to high social status and concerns about
public opinions in twitter-like microblogs. We plot the numbers of
users’ followers (i.e., in-degrees, which reflect users’ social status
to a certain extent) in unilateral and reciprocal follow relationships
in Weibo2 in Figure 3. We can find that one tends to follow other
users with higher out-degrees (which is also studied as disassortative degree mixing [29]), while reciprocal relationships are more
likely to establish between users with similar numbers of followers
(which is called assortativeness [25] in network science).

• Our model extends the concept of social communities to
better model information diffusion processes. We take community hierarchy into consideration in addition to social
tie strengths. Further, we incorporate communities’ topic
popularity along with their topic interests into our model
to capture the topic-aware and source-aware information
diffusion phenomenon.
• We design a constrained Gibbs sampling algorithm to estimate model parameters, which is computationally linear
w.r.t. the input network and retweeting logs. Those interpretable parameters can be exploited in several application
tasks.

1 The

father of mass communications, Wilbur Schramm, argues that it is no accident
that “community” and “communication” have the same word roots [28].
2 Sina Weibo is a popular microblogging service in China.

3 We

754

use the words “post” and “tweet” interchangeably in this paper.

Session 7A: Social

SIGIR’17, August 7-11, 2017, Shinjuku, Tokyo, Japan

Table 1: Notations used in this paper.
Symbols
U, V, C, K
Eu , D u
πu
θc
θc0
ψk
ϕ
ηcc 0
Ie
Id
se , se0
cd , cd0
zd
wdl
λ0 , λ1
ρ, α, α 0, γ , β

⇢

Descriptions
number of users, vocabularies, communities, and
topics
number of retweet logs of user u as a retweeter,
and links from user u
community membership, multinomial distribution
over communities of user u
topic interests, multinomial distribution over topics
of community c
topic popularity, multinomial distribution over topics of community c
multinomial distribution over words specific to
topic k
multinomial distribution over topics of the total
posts
topic-irrelevant social influence to community c
from community c 0
indicator of the existence of link e
indicator of the existence of retweet d
communities associated with follower and followee of link e
communities associated with target user and
source user of retweet d
topic of retweet d
the l-th word of retweet d
Beta priors on η
Dirichlet priors on πu , θc , θc0 , ψk , ϕ

⇡u

s0e

se

c0d

cd

Ie

zd

Id

wdl

Eu

⌘cc0

✓c
C

0,

Du
U

1

✓c0 0

2

k

C

↵

K

↵0

Figure 4: The Graphical Model Representation.
where each component πuc denotes user u’s tendency toward the
membership of community c.
Definition 2.2. Topic. A topic k ∈ [1, 2, ..., K] is represented by a
multinomial distribution over the vocabulary, denoted as ψk . Every
post d ∈ D is associated with a topic zd according to its textual
content wd .
Definition 2.3. Topic Interest and Topic Popularity. Every
community c has two components: a multinomial distribution θc ,
where θck represents the topic interest of community c toward topic
0 represents the topic
k; and a multinomial distribution θc0 , where θck
popularity of community c with regard to topic k.

• Through experiments on real datasets, we demonstrate substantial predictive performance improvement achieved by
our model compared with the existing work, and interesting insights concerning community hierarchy in microblog
social networks.

Definition 2.4. Community-level Influence Strength. There
is a Bernoulli distribution ηcc 0 between any two communities c and
c 0 , representing their topic-irrelevant influence strength.

The rest of this paper is organized as follows. Section 2 introduces our proposed model and its major application in information
diffusion prediction, while Section 3 reports our experimental analysis. We review literature in Section 4 and conclude our work in
Section 5.

Definition 2.5. Community Hierarchy. We divide communities into L hierarchical levels, denoted as l ∈ [1, 2, ..., L], where
level 1 representing the lowest level and level L the highest. Each
community c is pre-assigned to a specific hierarchical level lc .
All the notations used in this paper are listed in Table 1.

2 MODEL
2.1 Formulation

2.2

Model Description

Users take part in different communities in different settings. Therefore, we employ the mixed-membership approach [1]: each user u
is associated with a multinomial membership distribution vector
πu , where each component πuc = P (c |u) denotes the probability
that user u acts as a member of community c.
We also incorporate probabilistic semantic analysis into our
model. Each retweet log d = (u, v, wd ) ∈ D contains a bag of
words wd . We assign a topic zd to each d. The bag of words wd is
then drawn from the corresponding word distribution ψzd . Unlike
[19, 38], the topics are drawn from a consistent topic distribution
ϕ instead of a personalized topic distribution (e.g., ϕc ), because we
focus on retweets instead of original posts in our model and, of

We use G = (U, E) to denote the relationship network, where U
is the set of all users, E is the set of directed social links (e.g. whofollows-who relationships and retweet networks). D is used to
represent the set of retweet logs. Each retweet log d = (u, v, wd ) ∈
D denotes a post retweeted by the target user u from the source
user v with textual content wd .
Definition 2.1. Community. A social network consists of C communities denoted as c ∈ [1, 2, ..., C], where community members
intensively interact with each other and share similar social preferences. Each user u ∈ U may take part in multiple communities
in different contexts, according to a multinomial distribution πu ,

755

Session 7A: Social

SIGIR’17, August 7-11, 2017, Shinjuku, Tokyo, Japan

course, users who retweet those posts cannot control their textual
contents, which are usually determined by combined effect of the
entire social network.
In our model, every time a user u establishes a social link e to
user v, user u chooses to act as a member of a specific community
se , and user v is regarded as a member of specific community se0 .
The probability of the existence of link e is determined by the
community-level influence strength ηse se0 .
Likewise, each retweet log d is assigned to two communities cd
and cd0 , one for the target user (retweeter) u and one for the source
user v, denoting their community membership when taking this
retweeting action. In other words, inter-community interactions
serve as information diffusion channels in our model. In order to
capture the topic-aware and source-aware retweeting mechanism,
we assume that the retweeting decision depends on three factors:
the topic-irrelevant influence strength ηcd c 0 , the topic interest of
d
the target community θcd , and the topic popularity of the source
community θc00 . The first factor serves as the potential likelihood

to communities according to a pre-set partition. For instance, if
we want to associate 20% of communities with the highest level,
we can simply assign level L to the first 20% communities (i.e. let
lc = 1, ∀c ∈ [1, ..., bC/5c]), thanks to symmetry.
Figure 4 shows the graphical representation of our proposed
model. The generative process of all social links and retweet logs is
summarized in Algorithm 14 .
Algorithm 1 Generative process.
(1) For each community c = 1, 2, ..., C,
(a) Draw topic interest distribution, θc ∼ Dir (α ).
(b) Draw popularity distribution, θc0 ∼ Dir (α 0 ).
(c) For each community c 0 = 1, 2, ..., C,
(i) Draw the community-level influence strength,
ηcc 0 ∼ Beta(λ 0 , λ 1 ).
(2) For each topic k = 1, 2, ..., K,
(a) Draw the multinomial distribution over vocabularies,
ψk ∼ Dir (γ ).
(3) For each user u = 1, 2, ..., U ,
(a) Draw the community membership distribution,
πu ∼ Dir (ρ).
(b) For each link e = (u, v) ∈ Eu ,
(i) Draw user u’s community, se ∼ Cat (πu ).
(ii) Draw user v’s community, se0 ∼ Cat (πv ).
(iii) Draw the existence indicator, Ie ∼ Ber (ηse ,se0 ).
(c) For each retweet log d = (u, v, wd ) ∈ Du ,
(i) Draw user u’s community, cd ∼ Cat (πu ).
(ii) Draw user v’s community, cd0 ∼ Cat (πv ).
(iii) Draw topic indicator, zd ∼ Cat (ϕ)
(iv) Draw textual content, wd ∼ Mul (ψzd ).
(v) Draw the existence indicator,
Id ∼ Ber (ηcl ,c 0 θcd zd θc00 z ).

d

for retweet actions to occur, while the latter two determine whether
the potential likelihood is activated due to retweeters’ interests in
both the topic and the information source.
Here, we utilize both social links and retweet interactions to
model information diffusion, under the observation that retweet
interactions reflect information diffusion more accurately, but are
sparser than social links. Informally, social links serve as “priors”
for retweet interactions and become trivial when retweet logs are
sufficient.
Due to the sparsity of social networks, we only model positive
links and existing retweet logs; se , se0 and cd , cd0 exist if and only if
e ∈ E and d ∈ D, respectively. As in [18, 19], we use a Beta(λ 0 , λ 1 )
prior on each ηcc 0 and negative samples are implicitly modeled
in the beta-binomial hyper-parameters λ 0 = κ · ln(Nneд /C 2 ) and
λ 1 = 0.1, where Nneд = U (U − 1)(1 + D/E) − E − D and κ is a
tunable weight. Thus, linear model complexity w.r.t the number of
links and retweet logs can be achieved.
Finally, we address the notion of community hierarchy. Every
community c is pre-assigned to a hierarchical level lc . A social link
e can only be established when lse ≤ lse0 , and a retweet action d
can only occur when lcd ≤ lc 0 . That is, we assume information
d
flows downwards or horizontally, not upwards, because of social
status. Yet, such information diffusion processes of high complexity
as loops can still be captured thanks to multiple diffusion channels established between multiple community memberships. For
example, a user may receive a piece of information within a lower
level community (possibly from a higher one) and diffuse this piece
of information as a member of a higher level community she also
belongs to. For the same reason, the possibility that “high level”
users may retweet some high-quality posts from “low level” ones
is not ruled out.
Note that, in our model, we use with the same conjugate Beta
priors on η to model influence strengths across both inter- and
intra- level communities for tractability and simplicity. The posterior influence strengths across two anti-hierarchy communities
are minimized in the model inference stage, as explained later in
Section 2.3. Also, since community detection is an unsupervised
procedure in our model, we can arbitrarily assign hierarchical levels

l

2.3

d d

Inference and Parameter Estimation

In this section, we show how to estimate the latent space parameters
(i.e. π , θ , θ 0 , η, ϕ, ψ) from observed data (i.e. G (U, E), D). Like
that for many Bayesian models, exact inference for our proposed
model is difficult due to the intractable partition functions. We
therefore exploit the collapsed Gibbs sampling method (a widely
used Markov chain Monte Carlo algorithm): first, iteratively sample latent variables (i.e. z, c, c 0 , s, s 0 ) such that whose empirical
distribution converges to the posterior; then, use those samples
to estimate the model parameters of interest. The Gibbs sampling
process at each iteration is described as follows.
• Sample community indicators se , se0 for each link e =
(u, v) ∈ E according to
0
P (se = c, se0 = c 0 |s−e , s−e
, ·)
0

(c )
(c )

nc,c 0 +λ 1
nu +ρ
nv +ρ


· (·)
·
(·)

∝  nu +C ρ nv +C ρ nc,c 0 +λ0 +λ1
 0

4 Here, Cat

lc ≤ lc 0

(1)

lc > lc 0

and Mul stand for Categorical distribution and Multinomial distribution,
respectively.

756

Session 7A: Social

SIGIR’17, August 7-11, 2017, Shinjuku, Tokyo, Japan

• Sample community indicators cd , cd0 and the latent topic
zd for each retweet d = (u, v, w ) ∈ D according to

convergence study of our constrained Gibbs sampler are reported
in the Appendix.
Model Application. The obtained model parameters can be
used in several application problems. Specifically, π represents
the hierarchical community structure discovered by HCID, which
can be applied to collaborative recommendation tasks. Also, ϕ can
be exploited in topic extraction, while η along with communities’
topic interest θ and topic popularity θ 0 provides input parameters
for influence propagation models (e.g., Topic-aware Independent
Cascade model [3]) to conduct topic-aware top-K influencer retrieval
at the community level. At last, the major application of our model
is information diffusion prediction, which will be covered in Section
2.4.

0
P (cd = c, cd0 = c 0 |c−d , c−d
, z−d , zd = k, ·)
(c )
(c )
(k )

n u + ρ nv + ρ n c + α



·
·


(·)
(·)
(·)


nu + Cρ nv + Cρ nc + Kα



0(k )
0

∝
n 0 +α
nc,c 0 + λ 1

· c
·



0(·)
n

c,c 0 + λ 0 + λ 1

nc 0 + Kα 0



 0
0

lc ≤ lc 0

(2)

lc > lc 0

0
P (zd = k |c−d , c−d
, z−d , w, cd = c, cd0 = c 0, ·)
(k )

∝

nc

0(k )

+α

(·)

nc + Kα

·

n (k ) + β
(·)
0(·)
nc 0 + Kα 0 n + K β

QV
·

v=1

nc 0

+ α0

·

Qnd(v ) −1 (v )
q=0 (nk + q + γ )

2.4

(3)

2.4.1 Retweet Prediction. Retweet prediction is a common task
of diffusion analysis, whose aim is to predict whether a post d with
textual content wd from user v will be retweeted by another user
u in microblog settings. In other words, we are asked to estimate
the conditional probability that user u will retweet a post given its
content wd as well as source user v, namely P (u |wd , v) 5 .
In our approach, we regard this probability as a mixture over
the topic-aware user-to-user influence probabilities P (u |k, v) for
all the topics k ∈ [1, 2, ..., K],
X
P (u |wd , v) =
P (k |wd , v)P (u |k, v),
(4)

Qnd(·) −1 (·)
q=0 (nk + q + Vγ )

(c )

In the equations above, nu denotes the number of times when user
(k )
u acts as a member of community c in all links and retweets, nc
denotes the number of posts of topic k retweeted by community c,
0(k )
nc 0 is the number of posts of topic k retweeted from community
c’, nc,c 0 is the number of links from community c to community
(v )
c 0 and posts retweeted by community c from community c 0 , nk
represents the number of times word v is assigned to topic k and
(v )
n (k ) represents the number of posts assigned to topic k. nd is precalculated counts denoting the number of times word v occurs in
retweet d. We define z−d as all the topic indicators for posts except
0 , c , and c 0 . All the counts are
zd ; and the same with s−e , s−e
−d
−d
calculated with link e excluded in Eq. (1) and with post d excluded
in Eqs. (2-3).
After an appropriate number of iterations until convergence, the
estimates for the latent space parameters can be obtained with the
following formulas:
• Community membership π : πuc =

nc +α
.
(·)
nc +K α
0(k )
nc 0 +α 0
Topic popularity θ 0 : θc00k = 0(·)
.
nc 0 +K α 0
n 0 +λ 1
Influence strength η: ηcc 0 = n c,c
c,c 0 +λ 0 +λ 1
n (k ) +β
Topic distribution ϕ: ϕ k = n (·) +K β .
(v )
n +γ
Word distribution ψ: ψkv = (·)k
.
n k +V γ

• Topic interests θ : θck =
•
•
•
•

(k )

(c )

nu +ρ
(·)
nu +C ρ

Prediction Method

k

with mixture weights inferred through post d’s content and its
source user v’s topic interest,
Y
X
P (k |wd , v) ∝ P (k |v)P (wd |k, v) =
ψkwdl ·
πvc θck . (5)
l

c

The user-to-user influence can be converted into communitylevel diffusion probabilities via community memberships,
X
P (u |k, v) =
πuc · πvc 0 · P (c |k, c 0 ),
(6)
c,c 0

while the latter can be decomposed to the product of topic-irrelevant
influence strengths η, target communities’ topic interest θ and
source communities’ topic popularity θ 0 as discussed in Section 2.2

.

P (c |k, c 0 ) = ηcc 0 · θck · θc00k .
(7)
As in [19], we also find that top few communities are sufficient
to represent users’ behavioral preferences. On average, the top
three community memberships of a user u add up to 85.2%, and the
top ten 95.1%. This enables us to save a lot of computational costs
by only considering users’ top communities c and c 0 in Eqs. (5-6),
while top communities of each user can be obtained easily in the
offline pre-processing stage.
Compared to similar work, our prediction method not only considers users’ topic interests, but also takes source users’ topic popularity into account, which well captures users’ topic expertise,
topic-aware authoritativeness and other likewise phenomena. Additionally, influence strengths (i.e., η) not only indicates social tie
strengths, but also reflect social hierarchy in information diffusion.

.

Note again that, we first assign topic level indicators lc to each
community c according to pre-given ratios for different hierarchical
levels, and then implement the hierarchical community discovery
in the inference stage under the assumption that no anti-hierarchy
links and retweet actions would be observed. In other words, the
posterior probability of community indicators c and c 0 is zero if
they violate the hierarchical rules with lc > lc 0 , as we can see in Eqs.
(1-2) so that ηcc 0 is minimized. The mathematical derivation and

5 Here,

757

we slightly abuse the probability notation.

Session 7A: Social

SIGIR’17, August 7-11, 2017, Shinjuku, Tokyo, Japan

2.4.2 Cascade Prediction. In the retweet prediction, we focus on
direct user-to-user retweet behaviors, which serve as local “hops”
in the whole information diffusion process. In other words, the
content wd of a post retweeted by user ut ar дet from user usour ce
may not be originated by usour ce ; it can also be a post retweeted
from usour ce but originated from ur oot . In the latter case, we
say that ut ar дet , usour ce and other users who have retweeted the
same content are contaminated users in the information cascade
of content wd published by ur oot . As we can see, the information
cascading is global information diffusion phenomenon. In this task,
our goal is to predict whether a user u will be contaminated in a
given information cascade q = (ur oot , wd ).
We first study the cascading problem at the community level. For
each topic k, we construct a graph of communities G (k ) = (C, A(k ) ),
(k )
where Ak is an adjacency matrix with each component ac,c 0 =
0
P (c |k, c ), topic-aware community-level diffusion probability given
in Eq. (7). Then, we define the probability that community c will be
contaminated by a cascade originated from c 0 as
Y
(k )
Pc (c |k, c 0 ) =
max
ac i ,c i +1 , (8)
(c 1 =c,c 2, ...,cm =c 0 ) ∈ C ∗

In the following experiments, we only study two-layered community hierarchy for a simple and clear demonstration, although
community hierarchy with multiple levels can be implemented
with no extra cost. We use h to denote the ratios of higher level
communities. Further empirical study on community hierarchy is
reported at the end of this section.

3.1

i ∈[1,2, ...,m−1]

that is, the largest influence community c 0 can have on community c
through any possible path. This can be implemented easily with the
Floyd-Warshall algorithm [10] by taking negative logarithm of edge
weights and finding shortest paths for each pair of communities.
Note that, it is both theoretically unreasonable and computationally
prohibitive for traditional user-level models to utilize this approach
due to the huge differences among users’ in-degrees and the large
number of users.
At last, we use the same method as in the retweet prediction to
obtain the probability Pc (u |wd , v) of user u being contaminated by
substituting P (c |k, c 0 ) in Eq. (6) with Pc (c |k, c 0 ).

2.5

Complexity Analysis

Since only positive links and retweet logs are modeled in HCID,
the time complexity of the Gibbs sampling inference is linear w.r.t
the size of input data and times of iterations T , i.e., O (T (|E | + |D|))
given parameters C and K fixed. Further, in each iteration, the
sampling time for community indicators associated with each link
and each retweet is O (C 2 ), while the sampling for topics is O (|wd | ·
K ), where |wd | is the number of words in retweet d usually with
an upper limit of hundreds of words in microblogs.
The complexity of information diffusion prediction consists of
two parts. The offline pre-processing stage for retweet prediction
is O (U C) for extracting top-k communities for each user, while the
cost for cascade prediction is O (C (U + C 2 )) for an additional run of
the Floyd-Warshall algorithm. After that, the online prediction for
each retweet action takes only O (|w | · K ) in both of the two tasks.

3

Experimental Setup

3.1.1 Dataset. Weibo. We use a real-world dataset of Sina
Weibo from [37], containing both a relationship network G =
(U, E) and retweet logs D = {(u, v, wd )}.
In the data preprocessing step, stop words and the words occurred only once in the corpus are excluded; inactive users associated with less than 20 links and retweet logs in total are removed.
All the retweet logs were made between June 1, 2012 and August
31, 2012. In the final dataset we obtain, there are about 68K users,
8.1M links and 2.7M retweet logs containing 110M words in total.
The retweet logs D are split into training Dt r aininд (80%) and
test Dt est (20%). Although only true positive samples are modeled
in our approach, we need negative samples to evaluate predictive
performance of our model. We therefore construct a half-sized negative test set Dt est randomly selected from D = {(uneд , v, wd ) <
D}, where uneд is a follower of v who never retweeted a post with
content wd from v.
Moreover, to test model performance in the cascade prediction
task, we generate a cascade set Q t est = {(ur oot , w, Uc , Uc )}, where
Uc is the set of contaminated users who retweeted the original
post from ur oot with content w while Uc is the set of randomly
sampled uncontaminated users. It contains about 2K original posts’
cascading records which never appear in Dt r aininд , with average
19.6 contaminated users within each cascade.
DBLP. We further validate our model on an academic social network from DBLP[32]. The dataset is generated in a similar manner
to the Weibo dataset. Co-authorships and citations are regarded
respectively as “friendships” and “retweets”, where “tweets” are
titles along with abstracts of the cited research papers. In summary,
there are about 21K users, 2.3M links, and 5.9M “tweets” containing
412M words in total.
3.1.2 Baselines. We conduct comparison study with the following baseline models. Model (1-2) are two state-of-art information
diffusion modeling methods used to demonstrate performance improvement achieved by our approach. Model (3-4) are variants
of our proposed model used to illustrate the contribution of two
notions proposed in this paper, i.e., community hierarchy and topic
popularity.
(1) COLD. Proposed in [19], COLD (COmmunity Level Diffusion) is the state-of-art generative model for community
level information diffusion. In COLD, each user is also
represented by a community membership distribution, and
each community has a topic distribution that generates all
the posts published by itself. An interaction network derived from retweeting logs without semantic information
is modeled by pairwise Bernoulli distributions.
(2) CDK. Proposed in [6], CDK (Content Diffusion Kernel) is
a network embedding method to represent users in a latent
vector space in such a way that information diffusion can

EXPERIMENTS

In this section, we evaluate our proposed model using a real Weibo
dataset. The experimental results show that our proposed model
achieves substantial predictive performance improvement. We also
conduct an analysis to uncover why it outperforms other baseline
methods.

758

Session 7A: Social

SIGIR’17, August 7-11, 2017, Shinjuku, Tokyo, Japan

Table 2: AUC values of retweet prediction on Weibo. C and
K are the number of communities and topics, respectively.
Results of our proposed model are given for several values
of h, the ratio of the higher level communities. Results of the
baseline method No-Popularity are given for the best choice
of h.

No-Popularity
No-Hierarchy
HCID (h = 10%)
HCID (h = 25%)
HCID (h = 50%)

C=50
0.662
0.698
0.750
0.746
0.812
0.800
0.824
0.813
0.833
0.828
0.829
0.827

C=100
0.688
0.663
0.788
0.770
0.827
0.817
0.830
0.828
0.842
0.834
0.842
0.840

C=150
0.679
0.669
0.754
0.776
0.820
0.831
0.821
0.821
0.846
0.841
0.844
0.843

Figure 5: Retweet Prediction Performance on Weibo. h is set
to the optimal options for HCID.

Without Content

0.85

With Content

C=50

0.85

C=100

C=150

0.84

0.8

0.75

AUC

COLD

K
40
60
40
60
40
60
40
60
40
60
40
60

AUC

Method

0.83
0.82

0.7
0.81
0.65

be regarded as a heat diffusion process in that space. Information diffusion between two users is thereby predicted
by their Euclidean distance.
(3) No-Popularity. In this variant, we only use one topic
distribution to represent each community’s topical preference, thus not capable of differentiating communities’
topic popularity from their topic interests.
(4) No-Hierarchy. In this variant, community hierarchy is
not considered, and therefore links and retweet interactions can be established by any two communities.

3.2

COLD

No-Popularity No-Hierarchy

HCID

No-Hierarchy

h=10%

h=25%

h=50%

Figure 6: Performance Improvement Analysis on Weibo. If
not specified, C, K and h are set to the optimal parameter
options, i.e., 100, 40, and 25%, respectively.

We conduct further analysis on the performance improvement
by HCID. As discussed in Section 2.2, a retweet decision depends on
two parts, the topic-irrelevant influence strength from the source
user to the target and the content of the post. Figure 6(left) shows
the predictive performance results without and with the latter part,
respectively. We can see that the semantic content helps for NoHierarchy and HCID to obtain better performance, while the opposite for COLD and No-Popularity. This is not surprising for COLD
and No-Popularity which use the same distributions to model users’
topic preferences both as information spreaders and as information
receivers. In fact, there is only an averaged Jaccard similarity of
0.486 between the two sets of top three topics that a community
is most interested in and has the most popularity in, respectively.
This number is even smaller for lower level communities, which
is only 0.342, possibly because lower level communities generally
have diverse interests and unpredictable popularity in those topics. Besides, without taking advantage of posts’ retweeting source
makes COLD exhibit even worse performance. Furthermore, we
can find that HCID achieves better performance than No-Hierarchy
mainly because the introduction of community hierarchy improves
the community structure extraction, hence the estimation of topicirrelevant influence strengths.
Figure 6(right) shows the impact of different ratios of higher
communities h on the information diffusion prediction. For small h
(e.g., h = 10%), it is sufficient to use 100 communities to group users
who connect to each others closely and share similar behavior preferences. On the other hand, as h increases, users can be efficiently

Information Diffusion Prediction

We evaluate HCID’s predictive performance of information diffusion in two sub-tasks, the retweet prediction and the cascade
prediction. The two tasks respectively represent one “hop” and the
whole process of information diffusion.
3.2.1 Retweet Prediction Performance. The problem formulation
of retweet prediction is given in Section 2.4. Since no pre-defined
threshold for the existence of a given post in both our proposed
model and baseline models, we regard the diffusion prediction as an
information retrieval problem aiming to rank Dt est before Dt est
in terms of the diffusion probability calculated in Eq. (4), and use
Area Under the ROC Curve (AUC) and Precision-Recall Curves as
metrics. Note that CDK is not applicable to this task so that we
only compare the other baseline methods.
Table 2 lists the results of all comparison approaches on the
Weibo dataset. We can see that all three baseline methods perform
worse than our proposed model HCID. Figure 5 visualizes their
performances using Precision-Recall curves. We observe that more
topics do not necessarily bring better performances. It is possibly
because users usually do not differentiate topics very meticulously
when making retweet decisions and the overestimated number of
topics may cause overfitting problems.

759

Session 7A: Social

COLD
HCID

SIGIR’17, August 7-11, 2017, Shinjuku, Tokyo, Japan

CDK
HCID (Cold-Start)

COLD

0.8

Table 3: Comparison of the statistics of higher and lower
level communities with h = 25% and C = 100.
Statistics
Higher level Lower level
ratio of participation (tol.)
23.72%
76.28%
#user per community (avg.)
6372.4
6980.1
pagerank (avg.)
1.288
0.707
in-degree centrality (avg.)
0.0170
0.0078
betweenness centrality (avg.)
0.00020
0.00009

HCID

0.75
AUC

AUC

CDK

0.8

0.7

0.7
0.65

0.6

0.6

C=50

C=100

C=150

C=50

C=75

C=100

Figure 7: Cascade Prediction Performance on the Weibo(left)
and DBLP(right) dataset. C denotes the latent space dimensions for CDK, and h is set to the optimal options for HCID.

3.3 Community Hierarchy
Experiments above show that introducing the notion of community
hierarchy can bring substantial improvement with almost no additional cost. In this section, we will give an empirical comparison of
higher and lower communities for more insights.
Table 3 demonstrates some statistics of higher and lower communities in Weibo. Although social users seem to participate equally in
both of the higher and lower level communities, various metrics indicate users who are actively involved in higher level communities
have higher centrality than the others. As mentioned in Section
1, those higher level communities are more likely to be venues
for influential users who seldom follow “ordinary people” in the
lower level and cautiously retweet their posts due to high social
status and concerns about public opinions. Figure 8 justifies this
interpretation. The ratio of “Big V”s6 among active users in higher
level communities is significantly larger than that in lower level
communities.
Similar results can be also obtained in DBLP. It is worth mentioning that higher level community members (h is set to 25%) are up to
7 times more likely to serve as program committee (PC) members
of top-tier conferences, which shows that the community hierarchy
can reveal seniority and general authoritativeness (compared to
topical authoritativeness) of researchers in citation networks. The
conference data is obtained from [23], which covers six mainstream
research areas in computer science.

Figure 8: Comparison of the ratios of “Big V”s in active users
in different sets of communities in Weibo.
divided into more finer-grained communities with more precise
retweet patterns, thus achieving better predictive performance.
Therefore, we can conclude that the substantial performance
improvement by our proposed model HCID is achieved by incorporating the notions of topic popularity and community hierarchy,
along with the holistic retweet modeling approach taking posts’
retweeting source into account.

4

3.2.2 Cascade Prediction Performance. In addition to the capability of predicting a single “hop” (i.e., a retweet interaction between
two users) in the information diffusion process, our model HCID
is able to predict the whole message cascade. In order to evaluate the prediction results, we treat the prediction for each cascade
q ∈ Q t est as a retrieval task whose goal is to rank contaminated
users Uc before the uncontaminated Uc in that cascade. We then
average the AUC values for all cascades.
It is worthwhile to mention that there are some users (about 5%)
in Weibo test set Q t est who never posted any message recorded
in the retweet logs D t r aininд . Neither COLD nor CDK can predict
retweet actions regarding those users because no community membership distribution or embedding vector exists for them. Nonetheless, our model HCID can take advantage of users’ friendship network, and cold-start users associated with no retweet logs can still
be given a high-quality community membership distribution collaboratively. In our experiment, we first remove cold-start users for
a fair comparison. After that, we evaluate our model on the complete test. As shown in Figure 7, HCID outperforms other baseline
methods consistently on both Weibo and DBLP datasets.

RELATED WORK

Our work is closely related to information diffusion and probabilistic semantic analysis, while existing work on community detection
inspires our idea as well.
Information Diffusion. Information diffusion is a vast research domain, attracting extensive research interests [15], including influence maximization (e.g. [20, 21]) and influential node
detection (e.g. [23, 27]) with two types of information propagation
models, Independent Cascade Model [11] and Linear Threshold
Model [14]. Behind those approaches, there is a fundamental problem to model and estimate social influence between two nodes/users
(e.g. [12, 13, 33]), which is also more relevant to our work.
Gomez-Rodriguez et. al. proposes NETINF [12] to infer influence strengths between news media sites and blogs from citation
cascades. Tang et. al. [31] leverages a factor graph model to investigate the relationship between conformity and influence with
retweet cascades and users’ attributes. Topical Affinity Propagation (TAP) [30] models topic-level social influence, but it regards
6 In Weibo, verified accounts with more than 0.5M followers are called “Big V”, a
well-recognized concept to represent influential users.

760

Session 7A: Social

SIGIR’17, August 7-11, 2017, Shinjuku, Tokyo, Japan

topic extraction only as a pre-processing stage without considering
topics’ interdependence with network structures. Barbieri et. al.
[3] also incorporates topics into diffusion models and proposes
estimation methods for topic-aware influence strengths. However,
the topics are totally based on network structure without taking
advantage of semantic information. Finally, our work is most related to the Community Level Diffusion (COLD) model, which is a
novel approach to model information diffusion at the community
level proposed by Hu et. al. [19].
Probabilistic Semantic Analysis. Another line of existing
research is the probabilistic semantic analysis. Blei et. al. first
proposes a generative topic model LDA [5]. After that, Cha et. al.
[7] apply topic models to social network analysis. Zhao et. al. [39]
propose a content-based user in microblog settings.
Furthermore, various topic models are proposed combining semantic content with linking structures both in document citation
networks (e.g. Topic-Link-LDA [22], RTM [8]) and in social networks (e.g. SRTM [16], FLDA [4]). In most of those models, textual
contents and links are assumed to be generated by the same topic
distribution (in some literature, it is also called mixed-membership
of communities). However, this assumption is not well fitted with
social networks, especially microblogs, in two major reasons: first,
links are not necessarily relevant to users’ topic interests and they
also establish links due to social relationships or conformity; second, users’ strong interests in a certain topic do not always indicate
that they have significant popularity in that topic as well and such
complexity cannot be captured by a single consistent interest distribution for each user.
Community Detection. Our model captures social relationships and users’ preferences at the community level and can be
applied to community detection as well. While extensive discriminative approaches are proposed [26], our work is more relevant to
probabilistic generative community detection models. Airoldi et. al.
proposes the Mixed Membership Stochastic Block (MMSB) model
[1] where each user is associated with a membership distribution
over communities as HCID. Bonchi et. al. proposes the Cascadebased Community Detection (CCN) model [2], which discovers
overlapping communities by leveraging information cascading behaviors. Han et. al. introduces users’ social roles into network
structure modeling and community detection in the Community
Role Model (CRM) [17], which inspires our idea of community
hierarchy to some degree.

5

to incorporate more types of social contagions, such as clicking
“like”, into our generative framework to better understand information diffusion processes. Lastly, it might be an interesting and
challenging problem to study information diffusion across dynamic
communities with changing hierarchical structures.

ACKNOWLEDGMENTS
The authors would like to thank the anonymous reviewers for their
valuable comments and helpful suggestions. This work is supported
by 973 Program under Grant No. 2014CB340405, NSFC under Grant
No. 61532001 and No.61370054, and MOE-RCOE under Grant No.
2016ZD201.

REFERENCES
[1] Edoardo M Airoldi, David M Blei, Stephen E Fienberg, and Eric P Xing. 2008.
Mixed membership stochastic blockmodels. Journal of Machine Learning Research
9, Sep (2008), 1981–2014.
[2] Nicola Barbieri, Francesco Bonchi, and Giuseppe Manco. 2013. Cascade-based
community detection. In Proceedings of the sixth ACM international conference
on Web search and data mining. ACM, 33–42.
[3] Nicola Barbieri, Francesco Bonchi, and Giuseppe Manco. 2013. Topic-aware
social influence propagation models. Knowledge and Information System 37, 3
(2013), 555–584.
[4] Bin Bi, Yuanyuan Tian, Yannis Sismanis, Andrey Balmin, and Junghoo Cho. 2014.
Scalable Topic-specific Influence Analysis on Microblogs. In Proceedings of the
7th ACM international conference on Web search and data mining. ACM, 513–522.
[5] David M Blei, Andrew Y Ng, and Michael I Jordan. 2003. Latent dirichlet allocation. Journal of machine Learning research 3, Jan (2003), 993–1022.
[6] Simon Bourigault, Cedric Lagnier, Sylvain Lamprier, Ludovic Denoyer, and
Patrick Gallinari. 2014. Learning social network embeddings for predicting
information diffusion. In Proceedings of the 7th ACM international conference on
Web search and data mining. ACM, 393–402.
[7] Youngchul Cha and Junghoo Cho. 2012. Social-network analysis using topic
models. In Proceedings of the 35th international ACM SIGIR conference on Research
and development in information retrieval. ACM, 565–574.
[8] Jonathan Chang and David M Blei. 2009. Relational topic models for document
networks. In AISTATS. 81–88.
[9] Elena Erosheva, Stephen Fienberg, and John Lafferty. 2004. Mixed-membership
models of scientific publications. Proceedings of the National Academy of Sciences
101 (2004), 5220–5227.
[10] Robert W. Floyd. 1962. Algorithm 97: Shortest Path. Commun. ACM 5, 6 (June
1962), 345–. DOI:http://dx.doi.org/10.1145/367766.368168
[11] Jacob Goldenberg, Barak Libai, and Eitan Muller. 2001. Talk of the Network: A
Complex Systems Look at the Underlying Process of Word-of-Mouth. Marketing
Letters 12, 3 (2001), 211–223.
[12] Manuel Gomez Rodriguez, Jure Leskovec, and Andreas Krause. 2010. Inferring
networks of diffusion and influence. In Proceedings of the 16th ACM SIGKDD
international conference on Knowledge discovery and data mining. ACM, 1019–
1028.
[13] Amit Goyal, Francesco Bonchi, and Laks VS Lakshmanan. 2010. Learning influence probabilities in social networks. In Proceedings of the third ACM international
conference on Web search and data mining. ACM, 241–250.
[14] Mark Granovetter. 1978. Threshold Models of Collective Behavior. Amer. J.
Sociology 83, 6 (1978), 1420–1443.
[15] Adrien Guille, Hakim Hacid, Cécile Favre, and Djamel A Zighed. 2013. Information diffusion in online social networks: A survey. SIGMOD Record 42, 2 (2013),
17–28.
[16] Weiyu Guo, Shu Wu, Liang Wang, and Tieniu Tan. 2015. Social-Relational Topic
Model for Social Networks. In Proceedings of the 24th ACM International on
Conference on Information and Knowledge Management. ACM, 1731–1734.
[17] Yu Han and Jie Tang. 2015. Probabilistic community and role model for social
networks. In Proceedings of the 21th ACM SIGKDD International Conference on
Knowledge Discovery and Data Mining. ACM, 407–416.
[18] Qirong Ho, Rong Yan, Rajat Raina, and Eric P. Xing. 2012. Understanding the
Interaction between Interests, Conversations and Friendships in Facebook. CoRR
abs/1211.0028 (2012).
[19] Zhiting Hu, Junjie Yao, Bin Cui, and Eric Xing. 2015. Community level diffusion
extraction. In Proceedings of the 2015 ACM SIGMOD International Conference on
Management of Data. ACM, 1555–1569.
[20] David Kempe, Jon Kleinberg, and Éva Tardos. 2003. Maximizing the spread of
influence through a social network. In Proceedings of the ninth ACM SIGKDD
international conference on Knowledge discovery and data mining. ACM, 137–146.

CONCLUSION

In this paper, we propose a Hierarchical Community-level Information Diffusion (HCID) model. This model can not only help us
better understand information diffusion patterns by extracting communities which well reflect both the structural and the semantic
dimensions of information diffusion, but also have strong predictive
capability. We evaluate our model on two real datasets from, Weibo
and DBLP. Results show that our model outperforms other baseline
approaches, thanks to two innovative notions community hierarchy
and topic popularity that we propose in this paper.
There are several ways to extend our work in the future. One of
them is deeper investigation on more complex interaction mechanisms across multiple hierarchical community levels. We also plan

761

Session 7A: Social

SIGIR’17, August 7-11, 2017, Shinjuku, Tokyo, Japan

First, using Bayes’ rule, we can get the joint distribution of all
latent variables under the assumption A

[21] Jure Leskovec, Andreas Krause, Carlos Guestrin, Christos Faloutsos, Jeanne
VanBriesen, and Natalie Glance. 2007. Cost-effective outbreak detection in
networks. In Proceedings of the 13th ACM SIGKDD international conference on
Knowledge discovery and data mining. ACM, 420–429.
[22] Yan Liu, Alexandru Niculescu-Mizil, and Wojciech Gryc. 2009. Topic-link LDA:
joint models of topic and author community. In proceedings of the 26th annual
international conference on machine learning. ACM, 665–672.
[23] Tiancheng Lou and Jie Tang. 2013. Mining structural hole spanners through
information diffusion in social networks. In Proceedings of the 22nd international
conference on World Wide Web. ACM, 825–836.
[24] Ramesh Nallapati and William W Cohen. 2008. Link-PLSA-LDA: A New Unsupervised Model for Topics and Influence of Blogs. In Proceedings of the International
Conference on Web and Social Media.
[25] Mark EJ Newman. 2002. Assortative mixing in networks. Physical review letters
89, 20 (2002), 208701.
[26] Symeon Papadopoulos, Yiannis Kompatsiaris, Athena Vakali, and Ploutarchos
Spyridonos. 2012. Community detection in social media. Data Mining and
Knowledge Discovery 24, 3 (2012), 515–554.
[27] Mojtaba Rezvani, Weifa Liang, Wenzheng Xu, and Chengfei Liu. 2015. Identifying
top-k structural hole spanners in large-scale social networks. In Proceedings of the
24th ACM International on Conference on Information and Knowledge Management.
ACM, 263–272.
[28] Wilbur Schramm and Porter William. 1982. Men, women, messages, and media:
Understanding human communication. New York: Harper & Row.
[29] Mohsen Shahriari, Sebastian Krott, and Ralf Klamma. 2015. Disassortative Degree
Mixing and Information Diffusion for Overlapping Community Detection in
Social Networks (DMID). In Proceedings of the 24th International Conference on
World Wide Web Companion. 1369–1374.
[30] Jie Tang, Jimeng Sun, Chi Wang, and Zi Yang. 2009. Social influence analysis
in large-scale networks. In Proceedings of the 15th ACM SIGKDD international
conference on Knowledge discovery and data mining. ACM, 807–816.
[31] Jie Tang, Sen Wu, and Jimeng Sun. 2013. Confluence: Conformity influence
in large social networks. In Proceedings of the 19th ACM SIGKDD international
conference on Knowledge discovery and data mining. ACM, 347–355.
[32] Jie Tang, Jing Zhang, Limin Yao, Juanzi Li, Li Zhang, and Zhong Su. 2008. Arnetminer: extraction and mining of academic social networks. In Proceedings of
the 14th ACM SIGKDD international conference on Knowledge discovery and data
mining. ACM, 990–998.
[33] Rongjing Xiang, Jennifer Neville, and Monica Rogati. 2010. Modeling relationship strength in online social networks. In Proceedings of the 19th international
conference on World wide web. ACM, 981–990.
[34] Yang Yang, Jie Tang, Cane Wing-ki Leung, Yizhou Sun, Qicong Chen, Juanzi
Lit, and Qiang Yang. 2015. RAIN: Social Role-aware Information Diffusion. In
Proceedings of the Twenty-Ninth AAAI Conference on Artificial Intelligence. AAAI,
367–373.
[35] Zi Yang, Jingyi Guo, Keke Cai, Jie Tang, Juanzi Li, Li Zhang, and Zhong Su. 2010.
Understanding retweeting behaviors in social networks. In Proceedings of the
19th ACM international conference on Information and knowledge management.
ACM, 1633–1636.
[36] Nicholas Jing Yuan, Yuan Zhong, Fuzheng Zhang, Xing Xie, Chin Yew Lin,
and Yong Rui. 2016. Who Will Reply to/Retweet This Tweet?: The Dynamics
of Intimacy from Online Social Interactions. In Proceedings of the Ninth ACM
International Conference on Web Search and Data Mining. ACM, 3–12.
[37] Jing Zhang, Jie Tang, Juanzi Li, Yang Liu, and Chunxiao Xing. 2015. Who
influenced you? predicting retweet via social influence locality. ACM Transactions
on Knowledge Discovery from Data (TKDD) 9, 3 (2015), 25.
[38] Wayne Xin Zhao, Jing Jiang, Jianshu Weng, Jing He, Ee-Peng Lim, Hongfei Yan,
and Xiaoming Li. 2011. Comparing twitter and traditional media using topic
models. In European Conference on Information Retrieval. Springer, 338–349.
[39] Yukun Zhao, Shangsong Liang, Zhaochun Ren, Jun Ma, Emine Yilmaz, and
Maarten de Rijke. 2016. Explainable user clustering in short text streams. In
Proceedings of the 39th International ACM SIGIR conference on Research and
Development in Information Retrieval. ACM, 155–164.

A

P (c, c 0, s, s 0, z|A, ·)
∝ P (A|c, c 0, s, s 0, z, ·) · P (c, c 0, s, s 0, z|, ·).

(9)

From the graphical model representation in Figure 4, we then obtain
P (c, c 0, s, s 0, z|·)
∝ P (c, c 0, s, s 0 |ρ) · P (z|β ) · P (w |z, γ ) · P (I, I 0 |λ, c, c 0, s, s 0 ).

(10)

The conditional of se and se0 can be calculated by dividing the joint
distribution of all latent variables by the joint of all variables except
se and se0 ,
0
P (se = c, se0 = c 0 |s −e , s −e
, c, c 0, z, A, ·)

P (c, c 0, s, s 0, z|A, ·)
0 , z|A, ·)
P (c, c 0, s −e , s −e
0
P (A|c, c , s, s 0, z, ·)
P (c, c 0, s, s 0, z|·)
∝
·
0 , z, ·) P (c, c 0, s , s 0 , z|·)
P (A−e |c, c 0, s −e , s −e
−e −e
P (c, c 0, s, s 0 |ρ)
0
0
∝ P (Ae |se = c, se = c ) ·
0 |ρ)
P (c, c 0, s −e , s −e
0
0
0
P (I, I |λ, c, c , s, s )
·
0 |λ, c, c 0, s , s 0 ) .
P (I, I −e
−e −e
=

(11)

The first fraction of Eq. (11) is easy to obtain by the definition of
Ae ,
(
1 lse ≤ lse0
P (Ae |se , se0 ) =
(12)
0 lse > lse0 .
Next, we show how to derive the second fraction
R
P (π |ρ)P (c, c 0, s, s 0 |π )dπ
P (c, c 0, s, s 0 |ρ)
R
=
, (13)
0 |ρ)
0 |π )dπ
P (c, c 0, s −e , s −e
P (π |ρ)P (c, c 0, s −e , s −e
where the integrals can be calculated in the following way,
Z
P (π |ρ)P (c, c 0, s, s 0 |π )dπ
Z Y
Γ(Cρ) Y ρ−1 Y Y nu(c∗)
πu ∗ c dπ
=
πu ∗ c ·
Q
c Γ(ρ) c
u∗ c
u∗
Q
(c )
Y Γ(Cρ)
c Γ(nu ∗ + ρ)
=
.
·
Q
(·)
c Γ(ρ)
Γ(nu ∗ + Cρ)
u∗

(14)

By plugging Eq. (14) into Eq. (13) and canceling out the same terms
with the trick Γ(x + 1) = x Γ(x ), we can obtain
c0

ce
e
nu,−e
+ ρ nv,−e
+ρ
P (c, c 0, s, s 0 |ρ)
=
·
,
0
P (c, c 0, s −e , s −e |ρ) n (·) + ρ n (·) + ρ
u,−e
v,−e

(15)

while the third fraction in Eq. (11) can be obtained in a similar
fashion,
nc,c 0,−e + λ 1
0
0
P (I, I −e
|λ, c, c 0, s −e , s −e
)=
.
(16)
nc,c 0,−e + λ 0 + λ 1

SAMPLING HIERARCHICAL COMMUNITY
INDICATORS

Plugging Eq. (12) and Eqs. (15-16) into Eq. (11), we can finally
derive the sampling formula in Eq. (1), where the assumption A
and subscript −e are omitted for a clear demonstration. Similarly,
Eq. (2) can be derived.

In this paper, we design a constrained Gibbs sampling algorithm
under the assumption that no anti-hierarchy links and retweets
S
would be observed. We denote this assumption as A = e ∈ E Ae ∪
S
d ∈D Ad , where Ae and Ad represent the event ls e ≤ ls e0 and
lcd ≤ lc 0 respectively. Now we show the derivation of Eqs. (1-2).
d

762

