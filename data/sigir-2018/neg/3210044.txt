Session 2B: Social

SIGIR’18, July 8-12, 2018, Ann Arbor, MI, USA

Learning Geo-Social User Topical Profiles with Bayesian
Hierarchical User Factorization
Haokai Lu, Wei Niu, and James Caverlee
Department of Computer Science and Engineering, Texas A&M University
hlu,wei,caverlee@tamu.edu

ABSTRACT
Understanding user interests and expertise is a vital component
toward creating rich user models for information personalization
in social media, recommender systems and web search. To capture the pair-wise interactions between geo-location and user’s
topical profile in social-spatial systems, we propose the modeling
of fine-grained and multi-dimensional user geo-topic profiles. We
then propose a two-layered Bayesian hierarchical user factorization
generative framework to overcome user heterogeneity and another
enhanced model integrated with user’s contextual information to alleviate multi-dimensional sparsity. Through extensive experiments,
we find the proposed model leads to a 5~13% improvement in precision and recall over the alternative baselines and an additional
6~11% improvement with the integration of user’s contexts.
ACM Reference Format:
Haokai Lu, Wei Niu, and James Caverlee. 2018. Learning Geo-Social User
Topical Profiles with Bayesian Hierarchical User Factorization. In SIGIR ’18:
The 41st International ACM SIGIR Conference on Research and Development
in Information Retrieval, July 8–12, 2018, Ann Arbor, MI, USA. ACM, New
York, NY, USA, 10 pages. https://doi.org/10.1145/3209978.3210044

1

Figure 1: Learning geo-social user topical profiles. * indicates the grid where the cities locate.

INTRODUCTION

To illustrate these two geo-social factors, Figure 2 shows the heat
maps of the locations of Twitter users who have labeled Michael
Moore (@MMflint) and Roy Blunt (@RoyBlunt) using Twitter Lists.
This aggregate crowd-labeling of Twitter users has been used previously to derive user topical profiles [4, 9, 11]. For Factor (i), we
see that @MMFlint, as a filmmaker, is mainly known in New York
and LA, while he has a much broader impact for politics in regions such as San Francisco and D.C. For Factor (ii), @MMFlint
and @RoyBlunt are both known for politics, but @RoyBlunt is
known mainly in Missouri and D.C. while @MMFlint is known in
a much broader geo-scope.
Hence, these observations motivate the need for a careful study
of the impact of social-spatial properties on the creation of highquality user topical profiles. We propose in this paper to complement traditional user topical profiles with new fine-grained user
geo-topic profiles. These profiles are designed to capture the variations of user popularity for topics across geo-locations; essentially,
geo-topic profile is a multi-dimensional concept to describe and
model a user, and is expected to capture the pair-wise interactions
involving geo-locations and users’ topical profiles (see Figure 1).
Modeling user geo-topic profiles faces two major challenges,
however: (i) they are often overdispersed. Unlike the ratings or
content studied in many previous works [6, 12, 13], the popularity
counts in geo-topic profiles are of great variability in terms of
variance which is caused by user heterogeneity (some users are
much more popular than others); and (ii) they are often extremely
sparse due to multi-dimensionality, with many users often known
for very few topics at certain locations.

Uncovering user interests and expertise is a vital component of
search and recommendation systems [14, 16, 30, 37, 38]. For example, knowing a user is interested in tennis and proficient in
python can be used to augment newsfeed ranking algorithms to
surface high-quality content, improve item-based recommenders
by leveraging the topical expertise of knowledgeable users [3], and
enhance personalized web search [26, 30] and targeted ads [2].
While many existing user topical profiles focus on a global view
of each user, there are important geo-social factors that are critical
to consider: (i) First, individual users may be perceived differently in
different places; and (ii) Users with similar topical profiles can have
very different geo-spatial impact. Without careful consideration of
each of these factors, user topical profiles will lead to error-prone
recommendation (e.g., recommending content generated by local
foodies to people interested in food but living far away), low-quality
advertising (e.g., placing online ads of a new product by a tennis
equipment brand company in areas little known by local people)
and so on.
Permission to make digital or hard copies of all or part of this work for personal or
classroom use is granted without fee provided that copies are not made or distributed
for profit or commercial advantage and that copies bear this notice and the full citation
on the first page. Copyrights for components of this work owned by others than ACM
must be honored. Abstracting with credit is permitted. To copy otherwise, or republish,
to post on servers or to redistribute to lists, requires prior specific permission and/or a
fee. Request permissions from permissions@acm.org.
SIGIR ’18, July 8–12, 2018, Ann Arbor, MI, USA
© 2018 Association for Computing Machinery.
ACM ISBN 978-1-4503-5657-2/18/07. . . $15.00
https://doi.org/10.1145/3209978.3210044

205

Session 2B: Social

(a) @MMFlint known for politics

SIGIR’18, July 8-12, 2018, Ann Arbor, MI, USA

(b) @RoyBlunt known for politics

(c) @MMFlint known as filmmaker

Figure 2: Heatmaps of Twitter users listing (a) @MMFlint for politics; (b) @RoyBlunt for politics; (c) @MMFlint as a filmmaker.
Given these challenges, we first propose a multi-layered (twolayered in our case) Bayesian hierarchical user factorization which
generalizes Poisson gamma belief network [40] from modeling two
dimensional non-negative counts to multi-dimensional heterogeneous counts. The extra layer of user factorization learns a more
expressive user model than that of single-layered factorization by
allowing a larger variance-to-mean ratio on user geo-topic profiles,
thus making it better equipped at handling overdispersion and user
heterogeneity. To alleviate the sparsity issue, we investigate how
user’s contexts, specifically, geo-location and social ties, correlate
with one’s geo-topic profile, and then propose to integrate them into
the two-layered hierarchical model to learn better representation of
user’s geo-topic preference by others. Due to the non-conjugacy of
the multi-layered factorization scheme, we exploit a data augmentation scheme for negative binomial (NB) distribution and develop an
efficient closed-form Gibbs sampling formula for scalable inference.
We summarize the contributions as follows:
• First, we introduce multi-dimensional geo-topic profile to capture the pair-wise interactions between geo-location and user’s
topical profile, and formulate the problem of learning user’s geotopic profile to infer user’s location-sensitive topical profile.
• Second, to overcome overdispersed popularity counts caused by
user heterogeneity, we propose a two-layered Bayesian hierarchical user factorization (bHUF) generative framework, which
can be easily generalized to deep user factorization.
• Third, to alleviate sparsity, we investigate the impact of user’s
contexts, specifically, user’s geo-location and social ties, on user’s
geo-topic profile, and propose an enhanced model (bHUF+) by
exploiting user’s contexts. We then develop an efficient closedform Gibbs sampling scheme for inference using data augmentation schemes for NB distribution.
• Finally, we evaluate bHUF and bHUF+ against several baselines
over GPS-tagged Twitter datasets, and observe that bHUF gives
about 5%~13% improvement in precision and recall over the best
alternative one-layered baseline, and an additional 6%~11% improvement with user’s geo-location and social context.

2

models such as matrix factorization. For example, Hong et al. [15]
proposed probabilistic language models to uncover implicit geographical topics and user interests in social media. Cao et al. [5]
presented a matrix factorization-based approach to infer users’ topical profiles by exploiting their footprints. To increase user base and
engagement, many works [16, 19, 34, 37] create rich user models
for better user experience. For example, Zhao et al. [37] proposed a
matrix factorization based approach to build topical profiles by distinguishing user behaviors. Jiang et al. [19] presented a probabilistic
matrix factorization model to exploit social context to better predict
user adoption behaviors on Weibo. Most of these efforts, however,
focus on uncovering user’s topical profile or latent interests without
explicitly considering geo-social factors. In contrast, we propose
modeling user geo-topic profiles to explicitly infer location-sensitive
topical profiles with the combination of topical tags and locations.
Modeling discrete count data. An emerging line of research
[7, 12, 17, 35] has focused on modeling discrete count data with
Gamma-Poisson distribution instead of traditional Gaussians for
recommender systems [6, 12], topic modeling [13], spatial data
analysis [35] and political science [29]. For example, Gopalan et al.
[12] proposed Poisson matrix factorization for item recommendation and later developed collaborative topic Poisson factorization
[13] by integrating topic modeling for better article recommendation. Yu et al. [35] proposed a weakly-supervised labeled Poisson
factor model to predict the number of app openings at different
locations from mobile app usage. More recently, Schein et al. [29]
proposed Bayesian Poisson tensor factorization for inferring multilateral relations between countries based on political events data.
Compared with previous works, in our study, we focus on learning geo-social user topical profiles, and propose a multi-layered
contextual hierarchical user factorization framework which generalizes Poisson gamma belief network to modeling multi-dimensional
overdispersed sparse tensor counts.
Exploiting user’s contextual information. Various contextual
signals have been exploited to improve learning user’s latent preferences and behaviors in recommender systems, including text
[20, 32], social networks [19, 21, 23], geographical influence [18, 22]
and temporal context [7, 34]. For example, Want et al. [32] proposed
collaborative topic regression to learn latent user preference by
modeling both ratings and content. User’s social relations [19, 23]
have also been explored to regulate similar user’s latent preference for better recommendation. Hu et al. [18] considered business
geographical location to improve rating prediction. In this work,
we explore how user’s geo-location and social ties correlate with

RELATED WORK

Identifying user’s interests and expertise. Finding user interests and expertise is critical for many important applications, including personalized search [24, 26, 30], recommender systems
[14, 23, 37, 38], expert mining [9, 11, 33] and targeted advertising
[2]. Many of these applications seek to find interests or expertise
either explicitly [5, 8, 11, 14] via user relevant features and tags, or
uncover latent interest or expertise implicitly [2, 15, 36–38] with

206

Session 2B: Social

SIGIR’18, July 8-12, 2018, Ann Arbor, MI, USA

one’s geo-topic profile, and then extend the multi-layered user factorization to model user’s contexts so that it can capture the useful
information contained within user’s attributes.

3

PROBLEM DEFINITION AND CHALLENGES

We assume there exist a set of users U in a social-spatial network,
a dictionary of tags T that are used to indicate user’s topical profile
and a total of locations L. We use capital letters U , T and L to
represent their sizes, respectively. In a social-spatial network such
as Twitter or Linkedin, a user u is often tagged or followed by people
from different locations for her topical expertise t. For instance,
Twitter users are often tagged by others in lists with their own
selected keywords, with some examples shown in Figure 2. Linkedin
users can also use skill tags for their own profiles and be endorsed
by others with these tags. With these notations, we first give several
preliminary definitions as follows.

Figure 3: Left: probability mass function of user’s popularity
counts with a grid size of 2.5° × 2.5° (latitude by longitude).
Right: histogram of the number of geo-topic tokens. Similar
distributions have been observed in other sizes of grids.
decomposition with Poisson distribution as follows,

User’s Geo-Topic Token. A geo-topic token of user u is defined
t

yutl ∼ Poisson(

as a quadruplet {u ←
− v, l } indicating that user u is followed/tagged
by user v at location l with a tag t. To study user’s popularity of a
topic t at a location l, we aggregate all of u’s geo-topic tokens with
respect to t and l, and obtain a count y that indicates the extent to
which the user is popular.

K
Õ

θuk ϕ t k ψl k )

(1)

k =1

where θuk ∈ RK≥0 is the latent factor of u representing user’s geotopic preference by others. ϕ t k andψl k ∈ RK≥0 represents tag t’s and
location l’s latent factor. Each component of these latent factors is
drawn from conjugate Gamma distributions with shape parameter
α and rate parameter β. Small values of α induces sparsity and
better interpretability of inferred latent factors.
As a first pass, we can attack the problem with BPTF by using
inferred latent factors θuk , ϕ t k and ψl k to compute the expected
missing values in a user’s geo-topic profile. However, a preliminary
data analysis suggests that users’ geo-topic profiles present the
following two key challenges:
Challenge 1: Geo-topic profiles are overdispersed. To illustrate, we first plot the probability mass function of user’s popularity
counts in Figure 3. As we can see, the non-zero counts follow the
power law distribution with most of counts very low, ranging from
1 to almost a few hundreds with a variance-to-mean ratio about
15.4. The great variability of] counts can be explained by the fact
that users are often known by others to very different extent, i.e.,
some users can be very popular while others are lesser known.
This heterogeneity from users requires the underlying model to
better capture the higher moments (e.g., variance) of the data. However, the modeling capability of Equation 1 can be limited since its
variance is constrained to be equal to its mean, thus may cause underfitting when applied on these overdispersed popularity counts.
Challenge 2: Geo-topic profiles are extremely sparse. User’s
geo-topic profile, as is observed from our data, is extremely sparse
with only a small portion of non-zeros due to its multi-dimensionality.
Specifically, many users are often known for very few topics at certain locations. Indeed, our data shows a sparsity level of having
0.047% or 0.018% of non-zero counts at a grid size of 2.5° × 2.5° or
0.5° × 0.5° in terms of latitude by longitude. One common approach
to alleviate the issue is to exploit user’s contextual information
which commonly exists in social-spatial networks. However, it is
not clear whether user’s contexts have positive correlations with
one’s geo-topic profile, and if there is, how to model and integrate
them to better learn user’s geo-topic profile.

User’s Geo-Topic Profile. A user u’s geo-topic profile in a socialspatial network is defined to be a set of quadruplets Pu , with each
quadruplet pu representing this user’s popularity y, where y ∈ Z ≥0 ,
for topic t at location l, denoted {u, t, l, y}.
From the definition of user’s geo-topic profile, we can easily
obtain user’s topical profile {u, t, y} ∈ Tu by aggregating quadruplets Pu with the same topic. Similarly, user’s location profile
{u, l, y} ∈ Lu can be obtained by aggregating Pu with the same
location. Thus, user’s geo-topic profile provides a more generalized
and finer approach to profiling users by considering geo-spatial
influence of user’s topical profile. Very often, we are only able to
observe user’s geo-topic profile for partial tags or locations due to
limited visibility or geo-tagging capabilities of users. In light of this,
we formally define the following problem to infer user’s geo-topic
profiles for unknown topical tags or locations.
Learning User’s Geo-Topic Profile. Given partially observed
user geo-topic profile, i.e., a subset of quadruplets Puo ∈ Pu , our task
is to infer the unobserved quadruplets Pu − Puo by ranking user u’s
popularity for different tags at different locations, i.e., identify topranking tag-location combination {t, l } according to learned score
ŷutl for user u. The overall framework is illustrated in Figure 1.
Basic Approach with Bayesian Poisson Tensor Factorization
(BPTF). Bayesian Poisson factorization has shown promising performance for several tasks such as item and content recommendation [12, 13] by modeling count-valued data. By assuming Poisson
distribution in modeling counts instead of Gaussian distribution, it
is better at modeling the zero observations encountered in sparse
data [10] and enjoys scalable learning since only non-zeros are
considered during inference. It is extended to BPTF in [29] for modeling high dimensional sparse dyadic tensor data. In our context,
to model user u’s popularity for tag t at location l, denoted yutl
in our context, it is generated through Canonical PARAFAC (CP)

207

Session 2B: Social

4

SIGIR’18, July 8-12, 2018, Ann Arbor, MI, USA

BAYESIAN HIERARCHICAL USER
FACTORIZATION

To address the challenges, in this section, we first propose a twolayered hierarchical model (bHUF) to overcome geo-topic profile
overdispersion caused by user heterogeneity, and then investigate
how user’s contexts influence one’s geo-topic profile, and finally
present an enhanced model (bHUF+) by integrating user’s contexts
to alleviate the sparsity issue.

4.1

Figure 4: Overall generative framework.

Two-layered Hierarchical Model

bHUF is a hierarchically constructed multi-dimensional Bayesian
framework which generalizes the recently proposed Poisson Gamma
belief network [40] from modeling two dimensional non-negative
counts to modeling multi-dimensional tensor counts. Specifically,
it generates user latent factor with another layer of factorization by
decomposing it into the product of a second-layer user latent factor
and a weight-connection matrix. This multi-layered construction
is equivalent to modeling the counts with NB distribution which
is shown in later section to have a variance-to-mean ratio larger
than that of single-layered construction by a multiplicative factor.
As a result, it is better equipped at handling overdispersed counts
induced by user heterogeneity.
As in Equation 1, we assume user u’s popularity yutl for tag t
at location l is generated through CP decomposition with Poisson
distribution. However, in Equation 1, user’s latent factor is only
generated through Gamma priors with hyper-parameters. Instead,
we let each user’s latent factor be generated through a second layer
of factorization, with each first-layer user latent factor conditioned
upon a second-layer user latent factor. The overall generative framework, given yutl , is described as follows,
yutl ∼ Poisson(

K
Õ

Figure 5: Left: average users’ geo-topic profile similarities
with respect to the distance between users. Right: boxplots
for US GNN, US state, US random, world GNN, world timezone, world random.
three-dimensional models to higher dimensions, and as we will
show in section 4.3, to maintain the validity of lemma 1.
(2)
For both layers of user’s rate parameter βu and βu , we place
(2)
uninformative gamma priors on them: βu , βu ∼ Gamma(ϵ0 , ϵ0 ).
These user-dependent rate parameters are used to generate user’s
latent factor θuk and θuk2 to help explain the different degree of
overall popularity for each user. Note that we can easily generalize
the model to three or more (deep) layers by continuously factorizing
the second user’s latent factor θuk2 .

θuk ϕ t k ψl k )

k=1

θuk ∼ Gamma(θuk2 Ω, βu )
ϕ :m ∼ Dirichlet(ηt , ..., ηt )

(2)

4.2

ψ :m ∼ Dirichlet(ηl , ..., ηl )

Modeling User’s Contextual Information

Next, to alleviate the sparsity issue, we investigate two of the most
common user contexts in social-spatial networks — geo-location
and social ties by first exploring how these two factors correlate
with user’s geo-topic profiles, then followed by a contextualized
Bayesian hierarchical model to learn better user representation.

Ωk2 : ∼ Dirichlet(η 0 , ..., η 0 )
where θuk is Gamma distributed, with the shape parameter dependent on the second-layer user latent factor θuk2 . θuk2 is given a
Gamma distribution as a prior. For tag and location latent factor,
we impose Dirichlet distributions as their priors, where each column of the tag and location latent factor ϕ :m and ψ :m is Dirichlet
distributed. The weight matrix Ω ∈ RK2 ×K connects the first layer
user factor θuk to the second layer user factor θuk2 , and is expected
to capture the correlations between different layers of user factors.
Each row of Ω is given Dirichlet distribution as its prior.
Using Dirichlet distribution as the priors for tag, location and
weight matrices brings several benefits: (i) it naturally imposes nonnegativity constraints [10]; (ii) Since each column of ϕ :m and ψ :m is
restricted to have L 1 norm, they can be considered as a distribution
over the corresponding entities, resulting in better interpretability
of inferred tag and location factors; (iii) The L 1 norm of these factors
allows the tag and location factor not to directly interact with user’s
latent factors. This property is especially desired to generalize our

4.2.1 User’s Geo-location Context. To study the influence of
user’s geo-location, we need to define how to measure the similarity between users’ geo-topic profiles. To that end, we treat each
user’s geo-topic profile Pu as a distribution of counts indexed
by tag and location, and adopt Jenson-Shannon (JS) divergence
as the distance measure due to its symmetric and bounded property. Thus, the similarity between two user’s geo-topic profile Pua
and Pub is defined as 1 − JS(Pua , Pub ) where JS(Pua , Pub ) =
1 KL(P ||M) + 1 KL(P ||M). M is the average of P
ua
ub
u a and Pub
2
2
and KL(·) represents Kullback-Leibler divergence. The similarity
ranges from 0 to 1, with a large value indicating similar distributions
of two users’ geo-topic profiles.
We first show how geo-topic profile similarity between users
changes with respect to the geographical distance in Figure 5. As we

208

Session 2B: Social

SIGIR’18, July 8-12, 2018, Ann Arbor, MI, USA

Table 1: Pearson correlation coefficient between user’s profile similarity and their social similarity.
Location
US
world

Geo-topic profile
0.293
0.320

Topical profile
0.332
0.313

Location profile
0.142
0.237

Figure 6: Constructed user’s geo and social feature matrix.

can see, for both users in US and the world, the average similarity
is the highest when users are close to each other, specifically, when
they are within about 50 miles. It then drastically decreases as the
distance increases. This observation aligns with Tobler’s first law
[31] of geography which states that “near things are more related
than distant things”. In light of this, we next explore how geotopic similarity between geographically nearest neighbors (GNN)
compares against that of two random users. Figure 5 also shows
the boxplots of geo-topic similarities for a group of GNN in US/the
world (in terms of five neighbors) against a group of random users
in US/the world. As we can see, the similarities of GNN for both
datasets are statistically much higher than random users, suggesting
that GNN are more likely to share similar geo-topic profiles with
each other. Furthermore, we also obtain the state for each user in US
and timezone for each user in the world through reverse geo-coding.
We observe in Figure 5 that users in the same state or timezone
have statistically higher similarities than random users, indicating
that the state and timezone could also be useful geo-spatial features
for finding users with similar geo-topic profiles.

4.2.3 Modeling User’s Contextual Information. Previous analysis
shows that user’s geo-location and social information has corresponding influence over user’s geo-topic profile. One immediate
question is that how we can integrate these contexts into the model
for better representation of users. In this section, we propose an
extension to the previous two-layered user factorization model.
Let X denote the discrete matrix of user’s contextual features,
where each element is a binary indicating whether a user has a
corresponding feature. Specifically, we use X д ∈ ZU ×G and X f ∈
ZU ×F to denote user’s geo-spatial and social features, as illustrated
in Figure 6. For user’s geo-spatial features, we empirically select
five GNN for each user and their corresponding states (US) or
timezone (world), with each column of X д representing a feature.
For social features, each column of X f represents one of F followers.
To integrate X д and X f , we propose to generate the first layer of
user latent factor θuk on her corresponding contextual information.
Specifically, we linearly add feature’s latent factor to the shape
parameter of θuk , and let the inference process automatically learn
feature’s latent factor and its contribution to user’s latent factor.
Thus, our contextual user factorization goes as follows,

4.2.2 User’s Social Context. Due to the homophily effect [25],
socially connected users often share similar interests with each
other. Indeed, there have been many works [19, 23] that exploit
social ties in the applications such as recommendation and search.
Here, we explore how social ties in terms of a user following others
may affect geo-topic profiles. To that end, we first define users’
social similarity with their corresponding followers. Let Fa and
Fb denote the set of users following user ua and ub . We define
two user’s social similarity as the cosine similarity of Fa and Fb :
||Fa ∩ Fb ||/(||Fa ||||Fb ||), where each user is treated as a binary
vector indexed by each follower f ∈ F. Thus, a large similarity
of two users indicates that they are often followed by the same
followers. We then examine the Pearson correlation coefficient
between users’ geo-topic profile similarity and their social similarity
in Table 1. As we can see, for both users in US and the world, there
exists weak positive relationship between user’s geo-topic profile
similarity and their social similarity. This indicates that users tend
to share similar geo-topic profile, i.e., known for the same tags at
the same locations, if they are followed by a similar set of users.
Furthermore, we also show Pearson correlation between user’s
social similarity and user’s topical and location profile, as previously
defined in the Section 3. As we can see, user’s social similarity has a
weak positive relationship with user’s topical profile for both users
in US and the world. It, however, does not share similar degree
of positive relationship with user’s location profile. An intuitive
explanation is that users often follow each other for similar topical
interest, as the social homophily indicates, and that social ties have
more topical influence than geo-spatial influence.

θuk ∼ Gamma(θuk2 Ω +

G
Õ
д=1

Xuд λдk +

F
Õ

Xuf λ f k , βu )

(3)

f =1

where λдk and λ f k represents the latent factor of geo context д
and social context f , and are placed with uninformative Gamma
distribution as priors λдk , λ f k ∼ Gamma(ϵ0 , ϵ0 ). All the rest latent
factors are kept the same as in Equation 2. Since the first layer
user latent factor is also conditioned upon user’s contexts, θuk is
expected to not only reflect user’s preference through geo-topic
popularity counts but also user’s contextual information. This formulation is especially useful for “cold-start” users who have very
few counts in their geo-topic profiles. Our overall Bayesian contextual hierarchical user factorization (bHUF+) is shown in Figure 4.

4.3

Inference

Since our model makes use of Gamma shape parameters for the construction of the multi-layer factorization scheme on tensor counts,
it is not tractable to compute the exact posterior of the latent factors due to its non-conjugacy. However, we exploit the recently
proposed data augmentation scheme for NB distribution [39], and
develop an efficient closed-form Gibbs sampling formula with augmented distribution. Section B in the appendix explains the derived
Gibbs sampling scheme in further details.

209

Session 2B: Social

SIGIR’18, July 8-12, 2018, Ann Arbor, MI, USA

Table 2: Twitter Datasets.
Dataset
US
World

# of users
6,709
11,103

# of tags
240
304

# of labelers
148,623
327,313

For evaluation metrics, we adopt precision and recall to measure
the ranking performance between predictions and the hold-out
ground truth. Specifically, let GroundTruth(ui , n) denote the set of
top n ranked tag-location combination (t, l) according to y out of the
entire non-zero counts GroundTruth(ui ) for user ui in the testing
set, and let Pred(ui , n) denote the set of top n ranked tag-location
combination (t, l) according to model’s predictions for user ui , then,
ÍN |P r ed(ui ,n)∩Gr oundT r ut h(ui ,n) |
precision P@n is defined as N1 i=1
n
ÍN |P r ed(ui ,n)∩Gr oundT r ut h(ui ) |
and recall R@n is defined as N1 i=1
.
|Gr oundT r ut h(u i ) |
Thus, we can see that P@n represents the fraction of correctly identified tag-location combinations from the top n predictions, and
R@n represents the fraction of true non-zero tag-location combinations that are ranked in the top n predictions.

# of taggings
756,771
1,506,355

To see how tensor-based multi-layered user factorization can
overcome data overdispersion theoretically, we obtain and compare the variance-to-mean ratio given by one-layered (BPTF) and
two-layered (bHUF) user factorization, respectively. Specifically,
the following Lemma is reached showing that a two-layered construction of θuk is more capable of modeling overdispersed counts
by allowing a larger variance-to-mean ratio on the data. The proof
is given in Section A of the appendix.

Baselines. We use the following baselines for comparison:
– Pairwise Interaction Tensor Factorization (PITF) [28]. This is a
pairwise tensor factorization model which captures the pairwise
interactions between entities.
– CP Decomposition with gradient-based optimization (CP-OPT)
[1]. This method is based on minimizing least square between
CP and the observations with gradient descent. However, a direct
application with CP-OPT does not perform that well due to the
power law distribution of users’ geo-topic profiles. Therefore, we
first transform the counts y with loд(y + 1) and then apply CP-OPT.
– CP Alternating Poisson Regression (CP-APR) [10]. This method
is based on maximizing the likelihood of Poisson distribution on the
observed users’ geo-topic profiles, and is equivalent to minimizing
Kullback-Leibler (KL) divergence.
– Beta-Negative Binomial CP decomposition (BNBCP) [17]. This
Bayesian Poisson CP decomposition is based on a beta-negative
binomial construction with each entity’s latent factor generated by
Dirichlet distribution, and is a one-layered factorization model.
– Bayesian Poisson Tensor Factorization (BPTF) [29]. This is thestate-of-art Bayesian Poisson tensor model with each entity’s latent
factor generated through Gamma distribution, and is essentially a
one-layered model.
– Bayesian Hierarchical User Factorization (bHUF). We use bHUF1 and bHUF-2 to represent one-layered and two-layered model.
– Two-layered bHUF integrated with only user’s geo-location context (g-bHUF-2) and only user’s social context (s-bHUF-2).

Lemma 1. The variance-to-mean ratio of two-layered factorization
of θuk to θuk2 in Equation 2 is larger than that of one-layered θuk
1
by a factor of 1 +
(2) .
(1+βu )βu

5

EXPERIMENTAL EVALUATION

In this section, we conduct several experiments for evaluation.
Specifically, we seek to answer the following questions: (i) How
well does bHUF perform against alternative baselines? (ii) Do user’s
contexts help improve upon bHUF? (iii) How does bHUF and bHUF+
perform in two subproblems — predicting user’s topical and geo
profile? (iv) What impact do some important parameters have?
Data. We use a sample of about 12 million geo-tagged Twitter
lists collected from 2013 to 2014. Twitter lists [4, 11, 27] are crowdgenerated lists where a labeler can choose to place a user if the
labeler thinks the user is known for the topic indicated by the list
tags. Thus, a user is considered to be widely known for a topic
if the user is labeled by many labelers with the same tag. In our
experiments, we filter out infrequent tags which appear in less
than 50 lists to focus on quality tags. All users and labelers’ geocoordinates (latitude/longitude) are determined through their geotagged tweets by repetitively dividing and selecting the grid which
contains the most geo-tagged tweets as in [9]. We randomly sample
two datasets, show in Table 2: one is bounded in US in which
users and labelers are all in US, and the other is across the whole
t
world. Note that with these datasets, a geo-topic token {u ←
− v, l }
is formulated by treating a user as u, a labeler as v, the labeler’s
geo-coordinates as l and the list tag as t.

5.1

Comparison with Baselines

We first show the overall performance comparison in Table 3, with
all results averaged over 10 runs for Gibbs sampling. The grid size in
this experiment is set to 2.5° ∗ 2.5° (equivalent to approximately 175
miles ∗ 130 miles at latitude 40°) for both datasets. Other choices of
grid size are examined in later experiments. As we can see, overall,
the proposed bHUF+ gives the best performance among all methods
in terms of precision and recall. This confirms the superiority of the
two-layered user factorization integrated with user’s geo-location
and social contexts in modeling users’ over-dispersed and sparse
geo-topic profiles.

Experimental Setup. To evaluate the performance of our proposed bHUF and bHUF+ for inferring and ranking user’s geo-topic
profiles, we randomly select 50% of non-zero popularity counts for
each user for training and 50% of non-zero popularity for testing. We
use the same data split ratio for all other experiments. In our experiments, the latent dimension K is selected through cross-validation
from {50, 100, 150, 200, 250, 300} to be 200 since the performance of
all baselines plateaus around 200. For K 2 , we empirically set it to 50
and examine its impact in later experiments. The hyperparameter
ϵ0 is empirically set to 0.1 to encourage sparse solutions. For Gibbs
sampling, we use a burn-in period of 1000 iterations, and then use
another 1000 iterations to collect every tenth sample for all models.
All latent parameters are randomly initialized.

Comparison without user’s context. From Table 3, we observe
that two-layered user factorization bUHF-2 generally gives better performance than the single-layered Bayesian Poisson models.
Specifically, it gives an average improvement of 7.06% and 13.4%

210

Session 2B: Social

SIGIR’18, July 8-12, 2018, Ann Arbor, MI, USA

Table 3: Overall performance comparison. ‘†’ and ‘∗’ marks statistically significant improvement over the best one-layered
baseline and over bHUF-2, respectively. Both are evaluated according to two sample t-test at significance level 0.05.

PITF
CP-OPT
CP-APR
BNBCP
BPTF
bHUF-1

P@10
0.0801
0.1065
0.1333
0.1419
0.1409
0.1420

P@20
0.0876
0.1084
0.1358
0.1447
0.1442
0.1455

US
R@10
0.0582
0.1021
0.1298
0.1309
0.1300
0.1306

R@20
0.0863
0.1372
0.1674
0.1691
0.1679
0.1709

Imp. (P/R)
N/A
N/A
N/A
N/A
N/A
N/A

P@10
0.1019
0.1270
0.1465
0.1604
0.1627
0.1534

P@20
0.1006
0.1255
0.1447
0.1578
0.1587
0.1526

world
R@10 R@20
0.0832 0.1258
0.1418 0.1814
0.1666 0.2159
0.1785 0.2218
0.1788 0.2245
0.1628 0.2157

bHUF-2
g-bHUF-2
s-bHUF-2
bHUF+

0.1524
0.1630
0.1599
0.1708

0.1554
0.1664
0.1625
0.1691

0.1483
0.1590
0.1578
0.1667

0.1940
0.2034
0.2017
0.2134

7.06%† /13.4%†
7.01%∗ /6.03%∗
4.74%∗ /5.18%∗
10.4%∗ /10.7%∗

0.1703
0.1787
0.1763
0.1834

0.1664
0.1742
0.1730
0.1791

0.1912
0.1979
0.1964
0.2022

Method

for precision and recall over the best one-layered model for the US
dataset, and an average improvement of 4.76% and 8.30% for precision and recall for the world dataset. Additionally, we also observe
that methods modeled with Poisson distribution (including the nonBayesian model CP-APR) perform significantly better than CP-OPT,
and that Bayesian Poisson models (BNBCP, BPTF, bHUF-1) perform
better than the non-Bayesian version (CP-APR). This confirms that
(i) Two-layered user factorization has more expressive modeling
power over the single-layered models; (ii) User’s popularity count
values are better modeled with Poisson distribution with its latent
parameters regularized by proper priors.
Moreover, by examining the inferred user factors θuk and θuk2 ,
we obtain that the variance for θuk and θuk2 is 26.83 and 0.804,
indicating that the second-layer user factor has much less variance.
This indicates a more uniform distribution of the elements of θuk2
compared to the first-layer user factor and that using two layers of
user factorization can already explain the variance quite well.
Furthermore, to show that bHUF-2 can roughly capture user’s
geo-topic profile, we examine the top-ranking tags and locations
for user @MMFlint. We first compute the ranking of topical tags
for @MMFlint according to the inner product of θuk and all tag
factors, with the top five tags shown as: politics, entertainment,
movie, tv and art. We can see that these topical tags can roughly
capture @MMFlint’s topical interest and expertise. For the tag politics, we examine the top ranking regions for @MMFlint, with
the top five grid center coordinates give as: (40.319°, −74.638°),
(41.931°, −71.238°), (37.096°, −122.243°), (38.707°, −76.339°) and
(33.872°, −118.843°). Each location is close to New York, Boston,
San Jose, Washington D.C. and Los Angeles, respectively, which
generally agrees with the heat map in Figure 2. Note that these
coordinates are not exactly in these cities due to grid granularity.

0.2462
0.2558
0.2547
0.2636

Imp. (P/R)
N/A
N/A
N/A
N/A
N/A
N/A
4.76%† /8.30%†
4.80%∗ /3.70%∗
3.74%∗ /3.08%∗
7.66%∗ /6.41%∗

to improve predicting user’s geo-topic profile; and (ii) Equation 3 —
conditioning the first-layer user factor on a linear combination of
the second-layer user factor and her corresponding contexts — can
effectively learn the impact of contextual factors. Furthermore, the
integration with both contexts gives better performance than either
of them, suggesting that user’s geo-location is complementary to
the social context in terms of predicting one’s geo-topic profile.
These observations confirm that the sparsity issue is able to be
mitigated by integrating user’s relevant contextual information.

5.2

Predicting User’s Topical and Geo Profiles

Very often, we are interested in knowing only user’s topic profile –
what a user is known for – or user’s geo profile – where this user is
known for. Both problems can be considered as lower dimensional
subproblems of predicting user’s geo-topic profile by aggregating
quadruplets {u, t, l, y} ∈ Pu with respect to locations/tags. In this
section, we show how modeling a more generalized user geo-topic
profile can improve on either two subproblems. Specifically, we
use user, tag and location latent factor θuk , ϕ t k and ψl k inferred by
three-dimensional Bayesian Poisson models to obtain user-tag and
user-location score by computing the inner product of θuk and ϕ t k ,
and of θuk and ψl k . To compare with a two-dimensional model, we
use BPF [12] for modeling user-tag counts and user-location counts.
All models are evaluated with P@5 and R@5.
Predicting user’s topical profile. We show the performance comparison in Figure 7. As we can see, three dimensional models by
considering user’s geo-topic profile generally give much better
performance. This indicates that by distinguishing user’s topical
profile with geo-space, we can better predict user’s topical profile.
Among all methods, bHUF+ gives the best performance overall,
while bHUF-2 outperforms the one-layered models, which agrees
with the previous observation for predicting user’s geo-topic profile. Furthermore, we can see that models enhanced with user’s
contextual information significantly outperforms those without it,
confirming the importance of user’s contextual information. Specifically, s-bHUF-2 gives better performance than g-bHUF-2, indicating
that social context in terms of user’s followers is more informative
than user’s geo-location on learning user’s topical profile, which
agrees with the correlation analysis in Table 1.

Comparison with user’s context. From Table 3, we can observe
that bHUF+ enhanced with user’s contexts shows significant improvement over models without them. Specifically, the model integrated with user’s geo-location g-bHUF-2 gives an average improvement of 5.90% for precision and 4.86% for recall over bHUF-2,
while s-BHUF-2 gives an average improvement of 4.24% and 4.13%
for precision and recall over bHUF-2. This confirms that (i) user’s
context, specifically, user’s geo-location and social ties, can be used

211

Session 2B: Social

SIGIR’18, July 8-12, 2018, Ann Arbor, MI, USA

Figure 7: Precision and recall for predicting user’s topical
profile. Left: US. Right: world.

Figure 9: Performance comparison with respect to the size
of grid. Left: US. Right: world.

and starts to decrease passing 0.8° ∗ 0.8°. This indicates that for US
dataset, a grid size of about 0.8° ∗ 0.8° could be the best geo-space
partitioning for describing and modeling user’s geo-topic profile. A
larger grid may combine geo-topic tokens at two different locations
into one grid; while a smaller grid may over-partition a location,
thus causing sparsity issue. For precision on the world dataset, we
can see that it gives best performance when the grid is 2.5° ∗ 2.5°
(possibly larger), and that it always decreases when the grid gets
smaller. This indicates that a coarse-grained geo-partitioning is
better suited for the world dataset. As for R@10, all performance
increases as the grid gets larger. This could be explained by the
fact that as grid gets larger, there will be less number of grids
with non-zero counts to be retrieved, making the denominator in
recall definition smaller. Furthermore, no matter how we choose the
grid size, bHUF-2 consistently performs better than BPTF; and that
bHUF+, integrated with user’s geo-location and social contexts, also
consistently outperforms bHUF-2. This indicates that our proposed
models are robust with respect to grid size, and that one could
choose an appropriate grid size to her needs without degrading the
relative performance.

Figure 8: Precision and recall for predicting user’s location
profile. Left: US. Right: world.

Predicting user’s geo profile. We also show performance comparison in Figure 8. Similarly with user topical profile prediction,
three dimensional methods generally outperform BPF, and bUHF-2
performs better than one-layered models. Different from user topical profile prediction, g-bHUF-2 gives the best performance, while
s-bHUF-2 does not show as much improvement over bHUF-2. This
indicates that when predicting where a user is known by others,
user’s geo-location is more informative than user’s social context.
Together with the previous results, we conclude that user’s geolocation and social context improves on different aspects of user geotopic profile, and that one should select the appropriate context to
improve performance depending on the problem on hand. Note that
the improvement among all methods is generally not as significant
as that of user topical profile prediction. One possible hypothesis
could be that user’s geo profile has less inherent structure to learn
from than user’s topical profile, thus making it less likely to be
influenced by model improvements.

5.3

Impact of K 2 . How does the second-layer user latent dimension
size K 2 affect the performance? To that end, we run bHUF-2 for
US dataset with different values of K 2 ranging from 10 to 200, and
show the boxplots of P@10 and R@10 in Figure 10. As we can see,
as we increase the value of K 2 , both performance increases until it
saturates at about 40 for P@10 and R@100. We obtain similar trends
for the world dataset. We use 50 for K 2 for all previous experiments
for tradeoff between performance and efficiency. Furthermore, we
can see that even when K 2 is as small as 10, it still outperforms
the one-layered user models, indicating the superiority of an extra
layer of factorization.

Parameter Analysis

Impact of grid size. An important parameter in this study is grid
size. A larger grid size, indicating a larger geographical area for
each location, results in a smaller total number of locations in our
models. Thus, if the grid is large, user geo-topic profile is coarsegrained with respect to locations, while fine-grained when it is
small. Thus, it is important to see how the models perform with
respect to grid size.
To that purpose, we run our models with respect to four different
sizes of grid (latitude * longitude): 0.5° ∗ 0.5°, 0.8° ∗ 0.8°, 1.2° ∗ 1.2°
and 2.5° ∗ 2.5°. For each size, we compare precision and recall for
BPTF, bHUF-2, bHUF+ in Figure 9. As we can observe, for the US
dataset, the precision first increases when the grid size is small,

6

CONCLUSION

In this paper, we introduced multi-dimensional user geo-topic profile to capture the pair-wise interactions between geo-location and

212

Session 2B: Social

SIGIR’18, July 8-12, 2018, Ann Arbor, MI, USA

Then, given a tensor count yutl , we first reparametrize it as
Í
yutl = kK=1 yutl k , where each yutl k is a latent count and has
a Poisson distribution, yutl k ∼ Pois(θuk ϕ t k ψl k ). Then by the
Poisson-multinomial equivalence, yutl k can be sampled as
θ ϕ ψ
{yutl k } ∼ Mult(yutl ; ÍK uk t k l k )
(4)
θ ϕ ψ
k =1 uk t k l k
With the latent count sampled, we define several collective aggregates that are used in sampling as follows:
Figure 10: Precision@10 and recall@10 with respect to K 2 .

yuk · =

T Õ
L
Õ
t =1 l =1

yutl k , ytt k · =

U Õ
L
Õ
u=1 l =1

yutl k , yll k · =

U Õ
T
Õ
u=1 t =1

yutl k

user topical profile in social-spatial networks. To overcome overdispersion and user heterogeneity in geo-topic profiles, we proposed
a two-layered multi-dimensional Bayesian hierarchical user factorization framework. To alleviate the sparsity issue, we studied how
user’s context — user’s geo-location and social ties — correlates
with geo-topic profile, and proposed an enhanced model to integrate user’s contexts. Through Twitter-based social-spatial datasets,
we find bHUF leads to a 5~13% improvement in precision and recall
and an additional 6~11% improvement with user’s contexts.

We sample each latent factor with Gibbs sampling as follows,
Sampling ϕ t k . Due to the Dirichlet and Multinomial conjugacy,
each column of ϕ :k has a posterior Dirichlet distribution, which
can be sampled with

ACKNOWLEDGMENTS
This work was supported in part by NSF grant IIS-1149383.

Sampling θuk . Using Poisson-Gamma conjugacy, the posterior of
θuk is still a Gamma distribution and can be sampled with,

A

θuk ∼ Gamma(yuk · + θuk2 Ω +

t
t t
t
t
t
ϕ :k ∼ Dir (y1k
· + η , y 2k · + η , ..., y K k · + η )

Sampling ψl k . Similarly with ϕ t k , each column of ψ :k also has the
posterior Dirichlet distribution with
l
l l
l
l
l
ψ :k ∼ Dir (y1k
· + η , y 2k · + η , ..., y K k · + η )

PROOF OF LEMMA 1

From Equation 4 and Poisson-multinomial equivalence, we have
Í Í
Í
Í
yuk · ∼ Pois(θuk Tt=1 lL=1 ϕ t k ψl k ). Since Tt=1 ϕ t k = 1 and lL=1 ψl k
= 1, we have yuk · ∼ Pois(θuk ). We then consider two cases: the
first is that θuk is without further factorization, and the second
is that θuk is further factorized to θuk2 as in bHUF. For the first
case, let θuk ∼ Gamma(ϵ0 , βu ). By integrating out θuk , we have
1 . Thus the variance-to-mean
yuk · ∼ N B(ϵ0 , γu ), where γu = 1+β
u

1 . For case 2, from Equation 5, we
ratio of yuk · is given by 1−γ
ÍK u
Í
have yu ·k2 ∼ N B(θuk2 k =1 Ωk2 k , γu ). Since kK=1 Ωk2 k = 1, we
(2)

have yu ·k2 ∼ N B(θuk2 , γu ). Since θuk2 ∼ Gamma(ϵ0 , βu ), by the
law of total expectation and law of total variance, we obtain the
γ
0
expectation E(yu ·k2 ) = 1−γu u ϵ(2)
and the variance V ar (yu ·k2 ) =

βu
γu
γu
ϵ0
(1
+
).
Thus
the
variance-to-mean ratio of case 2 is
2
(2)
(2)
(1−γu ) βu
βu
1 (1 + γu ). We then reach the conclusion that the variance-to(2)
1−γu
βu
γu
mean ratio for case 2 is larger than case 1 by a factor of 1 + (2)
.
βu

B

G
Õ
д=1

Xuд λдk +

F
Õ

Xuf λ f k , 1 + βu )

f =1

Since the row of ϕ t : and ψl : are Dirichlet distributed with the L 1
norm 1, the posterior rate parameter of θuk is simplified to 1 + βu .
Thus, we can see that Dirichlet distributed ϕ t k and ψl k do not
interact with θuk directly, which provides nice isolation between
latent factors of users and other entities (tags and locations).
Sampling Ω. Using Poisson distribution’s additivity on yutl k ∼
Pois(θuk ϕ t k ψl k ) for each t and l gives us yuk · ∼ Pois(θuk ). Let
Í
θuk = i θuki , where θuki are latent parameters defined as


θ Ω , 1 ≤ i ≤ K2

 k2 k2 k

θuki = Xuд λдk , K 2 + 1 ≤ i ≤ K 2 + G


Xuf λ f k , K 2 + G + 1 ≤ i ≤ K 2 + G + F

Thus, by the Poisson-multinomial equivalence, we can sample corresponding yuki with {yuki } ∼ Mult(yuk · ; θuki ). For notation convenience, we let yukk2 = yuki for 1 ≤ i ≤ K 2 , yukд = yuki for K 2 +1 ≤
i ≤ K 2 + G and yuk f = yuki for the rest of i. Then, for 1 ≤ i ≤ K 2 ,
we have yukk2 ∼ Pois(θuki ) and θuki ∼ Gamma(θ k2 Ωk2 k , βu ) due
to infinite divisibility of Gamma distribution. We then integrate out
θuki , and have
yukk2 ∼ N B(θuk2 Ωk2 k , γu )
(5)

INFERENCE

We first present two lemmas [39] frequently used in the derivation.
Lemma 2. Suppose that y1 , ..., yK are independent random variÍK
Í
yk . Set θ = kK=1 θ k .
ables with yk ∼ Pois(θ k ) and y = k=1
The Poisson-multinomial equivalence states that (y1 , ..., yK ) ∼
Mult(y; θθ1 , ..., θθK ) and y ∼ Pois(θ ).

1 . Using data augmentation for NB distribution in
where γu = 1+β
u
Lemma 3, we can sample c indexed by u, k and k 2 with,

cukk2 ∼ CRT (yukk2 , θuk2 Ωk2 k )

Lemma 3. Suppose y ∼ N B(r , p) and c ∼ CRT (y, r ) is a Chinese
restaurant table distribution. Then y and c can also be jointly distributed as y ∼ SumLoд(c, p) and c ∼ Pois(−rln(1 − p)), where
Í
SumLoд is defined as y = ci=1 x i and x i ∼ Loд(p) is logarithmicdistributed random variable.

(6)

Then, given cukk2 , each row of Ωk2 : has a posterior Dirichlet distribution which can be sampled with,
Ωk2 : ∼ Dir (

U
Õ

u=1

213

cu1k2 + η 0 , ...,

U
Õ
u=1

cuK k2 + η 0 )

Session 2B: Social

SIGIR’18, July 8-12, 2018, Ann Arbor, MI, USA

Sampling θuk2 . With Equation 5 and 6 and using the data augmentation in Lemma 3 again, the posterior θuk2 has a Gamma
distribution, and can be sampled with
θuk2 ∼ Gamma(

K
Õ

k =1

[9] Zhiyuan Cheng, James Caverlee, Himanshu Barthwal, and Vandana Bachani.
2014. Who is the barbecue king of texas?: a geo-spatial approach to finding local
experts on twitter. In SIGIR.
[10] Eric C Chi and Tamara G Kolda. 2012. On tensors, sparsity, and nonnegative
factorizations. SIAM J. Matrix Anal. Appl. (2012).
[11] Saptarshi Ghosh, Naveen Sharma, Fabricio Benevenuto, Niloy Ganguly, and
Krishna Gummadi. 2012. Cognos: crowdsourcing search for topic experts in
microblogs. In SIGIR.
[12] Prem Gopalan, Jake M. Hofman, and David M. Blei. 2015. Scalable Recommendation with Hierarchical Poisson Factorization. In UAI.
[13] Prem K Gopalan, Laurent Charlin, and David Blei. 2014. Content-based recommendations with poisson factorization. In NIPS.
[14] Ido Guy, Naama Zwerdling, Inbal Ronen, David Carmel, and Erel Uziel. 2010.
Social media recommendation based on people and tags. In SIGIR.
[15] Liangjie Hong, Amr Ahmed, Siva Gurumurthy, Alexander J Smola, and Kostas
Tsioutsiouliklis. 2012. Discovering geographical topics in the twitter stream. In
WWW.
[16] Liangjie Hong, Aziz S Doumith, and Brian D Davison. 2013. Co-factorization
machines: modeling user interests and predicting individual decisions in twitter.
In WSDM.
[17] Changwei Hu, Piyush Rai, Changyou Chen, Matthew Harding, and Lawrence
Carin. 2015. Scalable bayesian non-negative tensor factorization for massive
count data. In ECML-PKDD.
[18] Longke Hu, Aixin Sun, and Yong Liu. 2014. Your neighbors affect your ratings:
on geographical neighborhood influence to rating prediction. In SIGIR.
[19] Meng Jiang, Peng Cui, Rui Liu, Qiang Yang, Fei Wang, Wenwu Zhu, and Shiqiang
Yang. 2012. Social contextual recommendation. In CIKM.
[20] Qi Liu, Enhong Chen, Hui Xiong, Chris HQ Ding, and Jian Chen. 2012. Enhancing
collaborative filtering by user interest expansion via personalized ranking. IEEE
Transactions on Systems, Man, and Cybernetics, Part B (Cybernetics) (2012).
[21] Xin Liu and Karl Aberer. 2013. SoCo: a social network aided context-aware
recommender system. In WWW.
[22] Haokai Lu and James Caverlee. 2015. Exploiting Geo-Spatial Preference for
Personalized Expert Recommendation. In RecSys.
[23] Hao Ma, Dengyong Zhou, Chao Liu, Michael R. Lyu, and Irwin King. 2011.
Recommender Systems with Social Regularization. In WSDM.
[24] Anirban Majumder and Nisheeth Shrivastava. 2013. Know your personalization:
learning topic level personalization in online services. In WWW.
[25] Miller McPherson, Lynn Smith-Lovin, and James M Cook. 2001. Birds of a feather:
Homophily in social networks. Annual review of sociology (2001).
[26] Feng Qiu and Junghoo Cho. 2006. Automatic identification of user interest for
personalized search. In WWW.
[27] Vineeth Rakesh, Dilpreet Singh, Bhanukiran Vinzamuri, and Chandan K Reddy.
2014. Personalized Recommendation of Twitter Lists using Content and Network
Information. In ICWSM.
[28] Steffen Rendle and Lars Schmidt-Thieme. 2010. Pairwise interaction tensor
factorization for personalized tag recommendation. In WSDM.
[29] Aaron Schein, John Paisley, David M Blei, and Hanna Wallach. 2015. Bayesian
poisson tensor factorization for inferring multilateral relations from sparse dyadic
event counts. In SIGKDD.
[30] Ahu Sieg, Bamshad Mobasher, and Robin Burke. 2007. Web search personalization
with ontological user profiles. In CIKM.
[31] Waldo R Tobler. 1970. A computer movie simulating urban growth in the Detroit
region. Economic geography (1970).
[32] Chong Wang and David M Blei. 2011. Collaborative topic modeling for recommending scientific articles. In SIGKDD.
[33] Jianshu Weng, Ee-Peng Lim, Jing Jiang, and Qi He. 2010. Twitterrank: finding
topic-sensitive influential twitterers. In WSDM.
[34] Hongzhi Yin, Bin Cui, Ling Chen, Zhiting Hu, and Zi Huang. 2014. A temporal
context-aware model for user behavior modeling in social media systems. In
SIGMOD.
[35] Rose Yu, Andrew Gelfand, Suju Rajan, Cyrus Shahabi, and Yan Liu. 2016. Geographic Segmentation via Latent Poisson Factor Model. In WSDM.
[36] Quan Yuan, Gao Cong, Zongyang Ma, Aixin Sun, and Nadia Magnenat Thalmann.
2013. Who, where, when and what: discover spatio-temporal topics for twitter
users. In SIGKDD.
[37] Zhe Zhao, Zhiyuan Cheng, Lichan Hong, and Ed H Chi. 2015. Improving user
topic interest profiles by behavior factorization. In WWW.
[38] Erheng Zhong, Nathan Liu, Yue Shi, and Suju Rajan. 2015. Building Discriminative
User Profiles for Large-scale Content Recommendation. In SIGKDD.
[39] Mingyuan Zhou and Lawrence Carin. 2015. Negative binomial process count and
mixture modeling. IEEE Transactions on Pattern Analysis and Machine Intelligence
(2015).
[40] Mingyuan Zhou, Yulai Cong, and Bo Chen. 2015. The Poisson gamma belief
network. In NIPS.

(2)

cukk2 + ϵ0 , βu − ln(1 − γu ))

Sampling λдk . For each user who have the geographical feature д,
i.e., Xuд = 1, we have yukд ∼ Pois(θuki ) for K 2 + 1 ≤ i ≤ K 2 + G,
and θuki ∼ Gamma(λдk , βu ) due to infinite divisibility of Gamma
distribution. Integrating out θuki , we have yukд ∼ N B(λдk , γu ). By
using data augmentation in Lemma 3, we can sample c indexed
by u, k and д with cukд ∼ CRT (yukд , λдk ). Given cukд , λдk has a
posterior Gamma distribution which can be sampled with
Õ
Õ
λдk ∼ Gamma(
cukд + ϵ0 , ϵ0 −
ln(1 − γu ))
u ∈U(д)

u ∈U(д)

where U(д) represents the set of users who have feature д.
Sampling λ f k . For each user who have follower f , i.e., Xuf =
1, we have yuk f ∼ Pois(θuki ) and θuki ∼ Gamma(λ f k , βu ) for
K 2 + G + 1 ≤ i ≤ K 2 + G + F . Thus, λ f k can be sampled similarly
with λдk as follows,
cuk f ∼ CRT (yuk f , λ f k )
Õ
Õ
λ f k ∼ Gamma(
cuk f + ϵ0 , ϵ0 −
ln(1 − γu ))
u ∈U(f )

u ∈U(f )

where U(f ) represents the set of users who have follower f .
(2)

(2)

Sampling βu and βu . The posterior of βu and βu are Gamma
distributions due to their conjugate Gamma priors, which can be
sampled with
βu ∼ Gamma(

K2
Õ
k 2 =1

θuk2 +

+ ϵ0 , ϵ0 +

K Õ
G
F
Õ
Õ
( X дk λдk +
X f k λf k )

k=1 д=1

K
Õ

f =1

θuk )

k=1
(2)

βu ∼ Gamma((K 2 + 1) ∗ ϵ0 , ϵ0 +

K2
Õ
k 2 =1

θuk2 )

REFERENCES
[1] Evrim Acar, Daniel M Dunlavy, and Tamara G Kolda. 2011. A scalable optimization
approach for fitting canonical tensor decompositions. Journal of Chemometrics
(2011).
[2] Amr Ahmed, Yucheng Low, Mohamed Aly, Vanja Josifovski, and Alexander J
Smola. 2011. Scalable distributed inference of dynamic user interests for behavioral targeting. In SIGKDD.
[3] Xavier Amatriain, Neal Lathia, Josep M Pujol, Haewoon Kwak, and Nuria Oliver.
2009. The wisdom of the few: a collaborative filtering approach based on expert
opinions from the web. In SIGIR.
[4] Parantapa Bhattacharya, Saptarshi Ghosh, Juhi Kulshrestha, Mainack Mondal,
Muhammad Bilal Zafar, Niloy Ganguly, and Krishna P Gummadi. 2014. Deep
twitter diving: Exploring topical groups in microblogs at scale. In CSCW.
[5] Cheng Cao, Hancheng Ge, Haokai Lu, Xia Hu, and James Caverlee. 2017. What
Are You Known For?: Learning User Topical Profiles with Implicit and Explicit
Footprints. In SIGIR.
[6] Allison JB Chaney, David M Blei, and Tina Eliassi-Rad. 2015. A probabilistic
model for using social networks in personalized item recommendation. In RecSys.
[7] Laurent Charlin, Rajesh Ranganath, James McInerney, and David M Blei. 2015.
Dynamic poisson factorization. In RecSys.
[8] Jilin Chen, Rowan Nairn, and Ed Chi. 2011. Speak little and well: recommending
conversations in online social streams. In SIGCHI.

214

