SIRIP: Industry Days

SIGIR’18, July 8-12, 2018, Ann Arbor, MI, USA

Machine Learning @ Amazon
Rajeev Rastogi
Amazon
rastogi@amazon.com

Question answering: Product pages often overwhelm customers
with a wealth of data, making discoverability of relevant
information a challenge, especially on mobiles. We have built a
Machine Learning system to answer product specific questions
using information on product pages such as product descriptions
and reviews. Thus, customers no longer have to read through
thousands of words on a product detail page, across product
descriptions, technical specifications and product reviews. They
can ask a question in their own words, without worrying about
knowing specific terms or technical jargon. Our system provides
an answer even when the question and content on product pages
do not have a single word in common. For example, to the question
“is this camera good for pictures at a basketball game?”, our
system answers “works great for sports photography”, quoting a
Customer Review. In a similar vein, the question “is this camera
expensive?” receives a response “the camera is great value for
money” from our system.

ABSTRACT
In this talk, I will first provide an overview of key problem areas
where we are applying Machine Learning (ML) techniques within
Amazon such as product demand forecasting, product search, and
information extraction from reviews, and associated technical
challenges. I will then talk about two specific applications where
we use a variety of methods to learn semantically rich
representations of data: question answering where we use deep
learning techniques and product size recommendations where we
use probabilistic models, and fake reviews detection where we use
tensor factorization algorithms.

CCS CONCEPTS
Machine Learning

KEYWORDS
Deep Learning, Question Answering, Bayesian Inference,
Recommendations

Building such a question answering system poses an exciting set
of challenges, such as understanding the user intent, semantic
matching of user questions and answers on the product page,
requirement of high precision, lack of extensive training datasets,
mixed-language questions and natural-language responses. In
order to find semantically matching snippets for a user question,
we learn joint embeddings for questions and snippets so that
semantically related questions and snippets have embeddings that
are close. We learn the embeddings using a Siamese Neural
Network trained on <question, relevant snippet, irrelevant
snippet> triples. We employ a triplet loss function that maximizes
the margin between cosine similarity scores of the question with
respect to relevant and irrelevant snippets. Evaluation on user
asked questions shows that the proposed system achieves 97%
precision which is a 66% improvement over TF-IDF based text
matching.

ACM Reference Format:
Rajeev Rastogi. 2018. Machine Learning @ Amazon. In SIGIR ’18: The
41st International ACM SIGIR Conference on Research and Development
in Information Retrieval, July 8–12, 2018, Ann Arbor, MI, USA. 2 pages.
https://doi.org/10.1145/3209978.3210211

1 INTRODUCTION
Amazon has been a pioneer in Artificial Intelligence (AI) and
Machine Learning (ML); early application of collaborative filtering
for product recommendations and Jeff Bezos’ letter to investors in
2010 mentioning “Random Forests” are two milestones in this
journey. As Amazon has rapidly grown and diversified in the past
decade, the business has relied heavily on Machine Learning
systems to improve customer experience and scale operations
through automation. Today, we apply Machine Learning
techniques to a wide range of problems at Amazon such as product
demand forecasting, product search, online advertising, product
classification, information extraction from reviews, voice
recognition, conversational systems, and robotics.
Below are two key initiatives aimed at improving customer
experience.
Permission to make digital or hard copies of part or all of this work for
personal or classroom use is granted without fee provided that copies are
not made or distributed for profit or commercial advantage and that copies
bear this notice and the full citation on the first page. Copyrights for thirdparty components of this work must be honored. For all other uses, contact
the Owner/Author.
SIGIR '18, July 8–12, 2018, Ann Arbor, MI, USA
© 2018 Copyright is held by the owner/author(s).
ACM ISBN 978-1-4503-5657-2/18/07.
https://doi.org/10.1145/3209978.3210211

1337

Product recommendations: Amazon has been a pioneer in
product recommendations – we proposed collaborative filtering
algorithms way back in the 1990’s. Amazon product pages feature
two popular widgets: “Customers who bought this also bought”
and “Customers who viewed this also viewed” – these widgets are
powered by highly scalable data mining algorithms that compute
products that are frequently purchased together and frequently
viewed together, respectively. We also learn customer preferences
from their browse and purchase history, and recommend products
to customers that match their preferences.
A specific recommendation problem is to recommend the product
size that would best fit a customer when the customer visits a

SIRIP: Industry Days

SIGIR’18, July 8-12, 2018, Ann Arbor, MI, USA

product page. The motivation for this is that in categories such as
Shoes and Apparel brands have different sizing conventions. For
example, a catalog size 6 corresponds to a physical size of 15cm
for Reebok while for Nike a catalog size 6 corresponds to a
physical size of 16cm. This leads to customers buying wrong
product sizes or buying multiple product sizes and then returning
the ones that don’t fit. We have developed Machine Learning
algorithms [1,2] that leverage past customer purchase and returns
data (e.g. product size was too large/small) to infer the best
product size for the customer.
Specifically, we propose a novel approach based on a Bayesian
logit regression model with ordinal categories {Small, Fit, Large}
to model size fits as a function of the difference between latent
sizes of customers and products. We propose posterior
computation based on mean-field variational inference,leveraging
the Polya-Gamma augmentation for the logit prior, that results in
simple updates, enabling our technique to efficiently handle large
datasets. Our Bayesian approach effectively deals with issues
arising from noise and sparsity in the data providing robust
recommendations. Offline experiments with real-life shoe datasets
show that our model outperforms the state of the art in 5 of 6
datasets.and leads to an improvement of 17-26% in AUC over
baselines when predicting size fit outcomes.

REFERENCES
[1] Vivek Sembium, Rajeev Rastogi, Atul Saroop, and Srujana Merugu.
Recommending product sizes to customers. RecSys, 2017.
[2] Vivek Sembium, Rajeev Rastogi, Lavanya Tekumalla, and Atul Saroop.
Bayesian models for product size recommendations. WWW, 2018.

BIOGRAPHY
Rajeev Rastogi is a Director of Machine Learning at Amazon
where he is developing ML platforms and applications for the ecommerce domain. Previously, he was Vice President of Yahoo!
Labs Bangalore and the founding Director of the Bell Labs
Research Center in Bangalore, India. Rajeev is an ACM Fellow and
a Bell Labs Fellow. He is active in the fields of databases, data
mining, and networking, and has served on the program
committees of several conferences in these areas. He currently
serves on the editorial boards of the CACM, VLDB Journal and
ACM Computing Surveys, and has been an Associate editor for
IEEE Transactions on Knowledge and Data Engineering in the
past. He has published over 125 papers, and holds over 50 patents.
Rajeev received his B. Tech degree from IIT Bombay, and a PhD
degree in Computer Science from the University of Texas, Austin.

1338

